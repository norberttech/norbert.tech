<!doctype html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Parquet - Wprowadzenie</title>
    <meta property="og:title" content="Parquet - Wprowadzenie" />
    <meta name="twitter:title" content="Parquet - Wprowadzenie" >

    <meta name="description" content="Kompletny przewodnik po Apache Parquet - binarnym, kolumnowym formacie plikÃ³w. Dowiedz siÄ™ jak osiÄ…gnÄ…Ä‡ 10x mniejsze pliki, wykorzystaÄ‡ metadata do bÅ‚yskawicznego filtrowania, zrozumieÄ‡ strukturÄ™ Row Groups i Data Pages, oraz poznaÄ‡ zaawansowane funkcje jak szyfrowanie i algorytmy Dremel.">
    <meta property="og:description" content="Kompletny przewodnik po Apache Parquet - binarnym, kolumnowym formacie plikÃ³w. Dowiedz siÄ™ jak osiÄ…gnÄ…Ä‡ 10x mniejsze pliki, wykorzystaÄ‡ metadata do bÅ‚yskawicznego filtrowania, zrozumieÄ‡ strukturÄ™ Row Groups i Data Pages, oraz poznaÄ‡ zaawansowane funkcje jak szyfrowanie i algorytmy Dremel.">
    <meta name="twitter:description" content="Kompletny przewodnik po Apache Parquet - binarnym, kolumnowym formacie plikÃ³w. Dowiedz siÄ™ jak osiÄ…gnÄ…Ä‡ 10x mniejsze pliki, wykorzystaÄ‡ metadata do bÅ‚yskawicznego filtrowania, zrozumieÄ‡ strukturÄ™ Row Groups i Data Pages, oraz poznaÄ‡ zaawansowane funkcje jak szyfrowanie i algorytmy Dremel.">

    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://norbert.tech/blog/2025-09-20/pl/parquet-wprowadzenie" />
                <meta property="og:image" content="https://norbert.tech/assets/images/blog/parquet-introduction/parquet-026fc09c95c7c7b4728c30bb85593777.jpg" />
                    
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://norbert.tech/blog/2025-09-20/pl/parquet-wprowadzenie" />
    <meta name="twitter:image" content="https://norbert.tech/assets/images/avatar-8f3c52c37f20d07c5e1631e1512bdeca.jpeg">
    <meta name="twitter:site" content="@norbert_tech" />
    <meta name="twitter:creator" content="@norbert_tech" />

    <link rel="apple-touch-icon" sizes="180x180" href="https://norbert.tech/assets/images/favicons/apple-touch-icon-9cae7ee880b4fe0bd755d300e1bca71e.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://norbert.tech/assets/images/favicons/favicon-32x32-b7a4ad4b584ab95534144e071f0e8587.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://norbert.tech/assets/images/favicons/favicon-16x16-154ca21abc06ae116c8d7ffc5713c000.png">
    <link rel="shortcut icon" href="https://norbert.tech/assets/images/favicons/favicon-db409885df78dea389e6d0b036da382c.ico">

            <style>
            @import url('https://fonts.googleapis.com/css2?family=Cabin:ital,wght@0,400..700;1,400..700&display=swap');
        </style>
        <link rel="stylesheet" href="https://norbert.tech/assets/styles/app-e24f407580be48180186fb40114b24be.css">
    
            
<script type="importmap">
{
    "imports": {
        "app": "https://norbert.tech/assets/app-930adf3462cf9ab60908eb1b74cf7ca7.js",
        "@oddbird/popover-polyfill": "https://norbert.tech/assets/vendor/@oddbird/popover-polyfill/popover-polyfill.index-7979d53637476aa204f709644aed2c19.js",
        "https://norbert.tech/assets/bootstrap.js": "https://norbert.tech/assets/bootstrap-d78d7e12c819dedf89372fb4824c072d.js",
        "htmx.org": "https://norbert.tech/assets/vendor/htmx.org/htmx.org.index-023ae86a082913526422a6063298f898.js",
        "iconify-icon": "https://norbert.tech/assets/vendor/iconify-icon/iconify-icon.index-8a41e423576dc2d752509fd455f508c1.js",
        "@symfony/stimulus-bundle": "https://norbert.tech/assets/@symfony/stimulus-bundle/loader-9311b8ea36bad0f6168e687b4d6dee73.js",
        "@hotwired/stimulus": "https://norbert.tech/assets/vendor/@hotwired/stimulus/stimulus.index-304681764684182e6662e0931532ed91.js",
        "https://norbert.tech/assets/@symfony/stimulus-bundle/controllers.js": "https://norbert.tech/assets/@symfony/stimulus-bundle/controllers-11c35dc7f11bbd855b8108888f18f9b7.js",
        "https://norbert.tech/assets/controllers/hello_controller.js": "https://norbert.tech/assets/controllers/hello_controller-55882fcad241d2bea50276ea485583bc.js",
        "https://norbert.tech/assets/controllers/syntax_highlight_controller.js": "https://norbert.tech/assets/controllers/syntax_highlight_controller-ae10e4cee8b4dedbf232536d05654062.js",
        "https://norbert.tech/assets/controllers/clipboard_controller.js": "https://norbert.tech/assets/controllers/clipboard_controller-6aefa8a9dec3271dae2f05b464bf9204.js",
        "highlight.js/lib/core": "https://norbert.tech/assets/vendor/highlight.js/lib/core-760145ef158caabe84ca07686407d093.js",
        "highlight.js/lib/languages/php": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/php-c0eb2105c14097e8a5a1e9a767e8ac95.js",
        "highlight.js/styles/github-dark.min.css": "data:application/javascript,document.head.appendChild%28Object.assign%28document.createElement%28%22link%22%29%2C%7Brel%3A%22stylesheet%22%2Chref%3A%22https%3A%2F%2Fnorbert.tech%2Fassets%2Fvendor%2Fhighlight.js%2Fstyles%2Fgithub-dark.min-4b46e20f66f76e35d6454ca4f09b57c3.css%22%7D%29%29",
        "@fontsource-variable/cabin/index.min.css": "data:application/javascript,document.head.appendChild%28Object.assign%28document.createElement%28%22link%22%29%2C%7Brel%3A%22stylesheet%22%2Chref%3A%22https%3A%2F%2Fnorbert.tech%2Fassets%2Fvendor%2F%40fontsource-variable%2Fcabin%2Findex.min-08e34691d22388e6974e6cb2bfbcbfd0.css%22%7D%29%29",
        "clipboard": "https://norbert.tech/assets/vendor/clipboard/clipboard.index-925566f98181665b5a61fea1bcd9033d.js",
        "highlight.js/lib/languages/shell": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/shell-664215791af27581e04813723523a355.js",
        "highlight.js/lib/languages/json": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/json-9ac51ad2a97f9ce56b2f309eb64d7b04.js",
        "highlight.js/lib/languages/twig": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/twig-0f3c6d18c0368650898b432b7bcf672a.js",
        "highlight.js/lib/languages/sql": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/sql-09f80640dd6fe9bed6ff4eb255b13f08.js",
        "highlight.js/lib/languages/javascript": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/javascript-100f963be02a503f0531e497103ff398.js",
        "highlight.js/lib/languages/xml": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/xml-a2295112e12d4d01f257d59e1cfa676d.js"
    }
}
</script>
<!-- ES Module Shims: Import maps polyfill for modules browsers without import maps support -->
<script async src="https://ga.jspm.io/npm:es-module-shims@1.10.0/dist/es-module-shims.js"></script>
<link rel="modulepreload" href="https://norbert.tech/assets/app-930adf3462cf9ab60908eb1b74cf7ca7.js">
<link rel="modulepreload" href="https://norbert.tech/assets/vendor/@oddbird/popover-polyfill/popover-polyfill.index-7979d53637476aa204f709644aed2c19.js">
<link rel="modulepreload" href="https://norbert.tech/assets/bootstrap-d78d7e12c819dedf89372fb4824c072d.js">
<link rel="modulepreload" href="https://norbert.tech/assets/vendor/htmx.org/htmx.org.index-023ae86a082913526422a6063298f898.js">
<link rel="modulepreload" href="https://norbert.tech/assets/vendor/iconify-icon/iconify-icon.index-8a41e423576dc2d752509fd455f508c1.js">
<link rel="modulepreload" href="https://norbert.tech/assets/@symfony/stimulus-bundle/loader-9311b8ea36bad0f6168e687b4d6dee73.js">
<link rel="modulepreload" href="https://norbert.tech/assets/vendor/@hotwired/stimulus/stimulus.index-304681764684182e6662e0931532ed91.js">
<link rel="modulepreload" href="https://norbert.tech/assets/@symfony/stimulus-bundle/controllers-11c35dc7f11bbd855b8108888f18f9b7.js">
<link rel="modulepreload" href="https://norbert.tech/assets/controllers/hello_controller-55882fcad241d2bea50276ea485583bc.js">
<script type="module">import 'app';</script>
                <script defer src="https://cloud.umami.is/script.js" data-website-id="9fed007d-d990-428b-b5d9-11c6ff55a3f1"></script>
    </head>
<body class="scroll-smooth text-black relative min-h-screen pb-16">
    <div class="sticky top-0 max-h-screen overflow-y-auto bg-white py-2 px-2 border-b border-gray-500 z-[9999] print:hidden">
        <div class="grid grid-cols-2 sm:mx-auto sm:max-w-screen-2xl md:px-4">
            <div class="text-left">
                <a href="/" class="text-lg">
                    norbert.tech
                </a>
            </div>
            <div class="text-right">
                <a href="/consulting" class="text-lg inline-flex items-center space-x-1 md:mr-4 mr-2">
                    <iconify-icon icon="lineicons:consulting" class="mr-1"></iconify-icon> Consulting
                </a>
                <a href="/blog" class="text-lg inline-flex items-center space-x-1">
                    <iconify-icon icon="ooui:articles-ltr" class="mr-1"></iconify-icon> Blog
                </a>
            </div>
        </div>
    </div>
    
    <main class="mx-auto max-w-screen-2xl mb-4 md:pt-4 px-4 lg:px-0">
            <div class="px-2 py-5 sm:px-4 md:px-8 lg:px-12 mx-auto max-w-4xl">
        <ul class="mt-2 pl-[20px] flex flex-wrap gap-2 sm:gap-4">
            <li>
                <a href="/blog" class="text-sm sm:text-base text-blue-500 hover:underline px-2 py-1 rounded">Go Back</a>
            </li>
                                                                <li>
                        <a href="/blog/2025-09-20/de/parquet-einfuehrung"
                           class="text-sm sm:text-lg px-2 py-1 rounded hover:opacity-80"
                           title="Deutsch">ğŸ‡©ğŸ‡ª Deutsch</a>
                    </li>
                                                                                <li>
                        <a href="/blog/2025-09-20/es/parquet-introduccion"
                           class="text-sm sm:text-lg px-2 py-1 rounded hover:opacity-80"
                           title="Spanish">ğŸ‡ªğŸ‡¸ Spanish</a>
                    </li>
                                                                                <li>
                        <a href="/blog/2025-09-20/parquet-introduction"
                           class="text-sm sm:text-lg px-2 py-1 rounded hover:opacity-80"
                           title="English">ğŸ‡ºğŸ‡¸ English</a>
                    </li>
                                                                                <li>
                        <a href="/blog/2025-09-20/it/parquet-introduzione"
                           class="text-sm sm:text-lg px-2 py-1 rounded hover:opacity-80"
                           title="Italian">ğŸ‡®ğŸ‡¹ Italian</a>
                    </li>
                                                                                <li>
                        <a href="/blog/2025-09-20/fr/parquet-introduction-fr"
                           class="text-sm sm:text-lg px-2 py-1 rounded hover:opacity-80"
                           title="French">ğŸ‡«ğŸ‡· French</a>
                    </li>
                                    </ul>

            </div>
    <article class="blog-post">
            <div class="img-wide">
        <img src="https://norbert.tech/assets/images/blog/parquet-introduction/parquet-026fc09c95c7c7b4728c30bb85593777.jpg" alt="Parquet - Introduction" />
    </div>

    <h1 class="font-bold text-4xl mb-2" id="title">Parquet - Wprowadzenie</h1>
    <div class="mb-2">
        <small class="text-sm">Data Publikacji September 20, 2025 00:00</small>
    </div>
    <div class="mb-4">
                    <small><span class="badge badge-info">parquet</span></small>
                    <small><span class="badge badge-info">binarny</span></small>
                    <small><span class="badge badge-info">kolumnowy</span></small>
                    <small><span class="badge badge-info">format plikÃ³w</span></small>
                    <small><span class="badge badge-info">kompresja danych</span></small>
                    <small><span class="badge badge-info">metadata</span></small>
                    <small><span class="badge badge-info">szyfrowanie</span></small>
                    <small><span class="badge badge-info">Apache Thrift</span></small>
                    <small><span class="badge badge-info">Flow PHP</span></small>
            </div>
    <p>
        Parquet, binarny, kolumnowy format plikÃ³w stworzony w celu wydajnego przechowywania oraz przeszukiwania danych.
    </p>
    <p>
        ArtykuÅ‚Ã³w na temat parquet jest w sieci caÅ‚e mnÃ³stwo, wiÄ™c dlaczego kolejny?<br/>
        Jest to moje spojrzenie na ten fantastyczny format, bÄ™dÄ…cy w zasadzie wynikiem moich doÅ›wiadczeÅ„ z pracy nad
        napisaniem implementacji parqueta w czystym PHP.
    </p>
    <p>
        Dla tych, ktÃ³rzy trafili tu przypadkiem, wspomnÄ™ tylko, Å¼e jestem autorem pierwszego frameworka do przetwarzania
        danych w PHP, o nazwie <a href="https://flow-php.com" target="_blank">Flow PHP</a>.<br/>
        Jak przystaÅ‚o na Data Frame, Flow musi umieÄ‡ czytaÄ‡ i zapisywaÄ‡ dane w rÃ³Å¼nych formatach, w tym Parquet<br/>
    </p>
    <p>
        PoniewaÅ¼ jednak jedyna implementacja, ktÃ³rÄ… znalazÅ‚em, byÅ‚a w zasadzie bezpoÅ›rednim portem z C#, ktÃ³ry w dodatku
        nie do koÅ„ca radzi sobie z gÅ‚Ä™boko zagnieÅ¼dÅ¼onymi strukturami, oraz posiada sporo brakujÄ…cych funkcji, postanowiÅ‚em
        w ramach nauki, napisaÄ‡ wÅ‚asnÄ… implementacjÄ™ od zera, co okazaÅ‚o siÄ™ niezwykle cennym doÅ›wiadczeniem ale i Å›wietnÄ…
        zabawÄ….
    </p>
    <a href="#why-parquet"><h2 id="why-parquet">Dlaczego Parquet</h2></a>
    <ul>
        <li><a href="#binary-format">Format Binarny - nawet o 10x mniejszy rozmiar plikÃ³w</a></li>
        <li><a href="#metadata">Metadata - Å‚atwiejszy dostÄ™p do wybranych danych</a></li>
        <li><a href="#schema">Schema - gwarancja poprawnej struktury</a></li>
        <li><a href="#compression">Kompresja - dodatkowa redukcja rozmiaru</a></li>
        <li><a href="#encryption">Szyfrowanie - na poziomie, pliku, metadanych, kolumn czy stron</a></li>
    </ul>

    <a href="#binary-format"><h2 id="binary-format">Format Binarny</h2></a>
    <p>
        DziÄ™ki temu, Å¼e format ten jest zorientowany na kolumny, nie wiersze, pozwala na bardzo wydajnÄ… kompresjÄ™ danych,
        co przekÅ‚ada siÄ™ na znacznie mniejszy rozmiar pliku. Bez wiÄ™kszego wysiÅ‚ku parquet potrafi skompresowaÄ‡ dane nawet o <strong>10 razy</strong>,
        w porÃ³wnaniu z tradycyjnymi formatami jak np. CSV czy XML.
    </p>
    <p>
        JeÅ¼eli wiÄ™c te same dane, zapisane w formacie CSV zajmujÄ… 1Gb, to w formacie parquet mogÄ… zajÄ…Ä‡ zaledwie 100Mb.<br/>
    </p>

    <p>
        Na potrzeby tego wpisu wygenerowaÅ‚em 2 pliki, jeden w formacie CSV, drugi w formacie Parquet.<br/>
        Struktura tych plikÃ³w jest bardzo prosta, zawiera 10 kolumn i 10mln wierszy, ktÃ³re wyglÄ…dajÄ… mniej wiÄ™cej tak:
    </p>
    <pre><code class="code-shell" data-controller="syntax-highlight">index,order_id,created_at,updated_at,discount,email,customer,address,notes,items
0,254d61c5-22c8-4407-83a2-76f1cab53af2,2025-01-01T12:00:00+00:00,2025-01-01T12:10:00+00:00,24.4,user-0@example.com,&quot;John Doe 0&quot;,&quot;{&quot;&quot;street&quot;&quot;:&quot;&quot;123 Main St, Apt 0&quot;&quot;,&quot;&quot;city&quot;&quot;:&quot;&quot;City &quot;&quot;,&quot;&quot;zip&quot;&quot;:&quot;&quot;12345-0&quot;&quot;,&quot;&quot;country&quot;&quot;:&quot;&quot;PL&quot;&quot;}&quot;,&quot;[&quot;&quot;Note 1 for order 0&quot;&quot;,&quot;&quot;Note 2 for order 0&quot;&quot;,&quot;&quot;Note 3 for order 0&quot;&quot;]&quot;,&quot;[{&quot;&quot;sku&quot;&quot;:&quot;&quot;SKU_0001&quot;&quot;,&quot;&quot;quantity&quot;&quot;:1,&quot;&quot;price&quot;&quot;:0.14},{&quot;&quot;sku&quot;&quot;:&quot;&quot;SKU_0002&quot;&quot;,&quot;&quot;quantity&quot;&quot;:2,&quot;&quot;price&quot;&quot;:25.13}]&quot;
1,254d61c5-22c8-4407-83a2-76f1cab53af2,2025-01-01T12:00:00+00:00,2025-01-01T12:10:00+00:00,24.4,user-1@example.com,&quot;John Doe 1&quot;,&quot;{&quot;&quot;street&quot;&quot;:&quot;&quot;123 Main St, Apt 1&quot;&quot;,&quot;&quot;city&quot;&quot;:&quot;&quot;City &quot;&quot;,&quot;&quot;zip&quot;&quot;:&quot;&quot;12345-1&quot;&quot;,&quot;&quot;country&quot;&quot;:&quot;&quot;PL&quot;&quot;}&quot;,&quot;[&quot;&quot;Note 1 for order 1&quot;&quot;,&quot;&quot;Note 2 for order 1&quot;&quot;,&quot;&quot;Note 3 for order 1&quot;&quot;]&quot;,&quot;[{&quot;&quot;sku&quot;&quot;:&quot;&quot;SKU_0001&quot;&quot;,&quot;&quot;quantity&quot;&quot;:1,&quot;&quot;price&quot;&quot;:0.14},{&quot;&quot;sku&quot;&quot;:&quot;&quot;SKU_0002&quot;&quot;,&quot;&quot;quantity&quot;&quot;:2,&quot;&quot;price&quot;&quot;:25.13}]&quot;
2,254d61c5-22c8-4407-83a2-76f1cab53af2,2025-01-01T12:00:00+00:00,,,user-2@example.com,&quot;John Doe 2&quot;,&quot;{&quot;&quot;street&quot;&quot;:&quot;&quot;123 Main St, Apt 2&quot;&quot;,&quot;&quot;city&quot;&quot;:&quot;&quot;City &quot;&quot;,&quot;&quot;zip&quot;&quot;:&quot;&quot;12345-2&quot;&quot;,&quot;&quot;country&quot;&quot;:&quot;&quot;PL&quot;&quot;}&quot;,&quot;[&quot;&quot;Note 1 for order 2&quot;&quot;,&quot;&quot;Note 2 for order 2&quot;&quot;,&quot;&quot;Note 3 for order 2&quot;&quot;]&quot;,&quot;[{&quot;&quot;sku&quot;&quot;:&quot;&quot;SKU_0001&quot;&quot;,&quot;&quot;quantity&quot;&quot;:1,&quot;&quot;price&quot;&quot;:0.14},{&quot;&quot;sku&quot;&quot;:&quot;&quot;SKU_0002&quot;&quot;,&quot;&quot;quantity&quot;&quot;:2,&quot;&quot;price&quot;&quot;:25.13}]&quot;
3,254d61c5-22c8-4407-83a2-76f1cab53af2,2025-01-01T12:00:00+00:00,,24.4,user-3@example.com,&quot;John Doe 3&quot;,&quot;{&quot;&quot;street&quot;&quot;:&quot;&quot;123 Main St, Apt 3&quot;&quot;,&quot;&quot;city&quot;&quot;:&quot;&quot;City &quot;&quot;,&quot;&quot;zip&quot;&quot;:&quot;&quot;12345-3&quot;&quot;,&quot;&quot;country&quot;&quot;:&quot;&quot;PL&quot;&quot;}&quot;,&quot;[&quot;&quot;Note 1 for order 3&quot;&quot;,&quot;&quot;Note 2 for order 3&quot;&quot;,&quot;&quot;Note 3 for order 3&quot;&quot;]&quot;,&quot;[{&quot;&quot;sku&quot;&quot;:&quot;&quot;SKU_0001&quot;&quot;,&quot;&quot;quantity&quot;&quot;:1,&quot;&quot;price&quot;&quot;:0.14},{&quot;&quot;sku&quot;&quot;:&quot;&quot;SKU_0002&quot;&quot;,&quot;&quot;quantity&quot;&quot;:2,&quot;&quot;price&quot;&quot;:25.13}]&quot;
</code></pre>

    <p>
        Efekt kompresji jest naprawdÄ™ imponujÄ…cy:
    </p>

    <pre><code class="code-shell" data-controller="syntax-highlight">4.1G Sep 20 18:32 orders.csv
437M Sep 20 18:47 orders.parquet</code></pre>

    <p>
        PrzekÅ‚ada siÄ™ to nie tylko na koszty przechowywania, ale i przetwarzania danych.<br/>
        SzczegÃ³lnie kiedy nasze dane Å¼yjÄ… w chmurze, czy to na Azure Bucket, czy AWS S3. Jednym z wiÄ™kszych czynnikÃ³w wpÅ‚ywajÄ…cych
        na rachunek nie jest wcale rozmiar danych, a to ile transferu zuÅ¼ywamy, aby te dane odczytaÄ‡ / zapisaÄ‡.
    </p>
    <p>
        RedukujÄ…c rozmiar pliku, redukujemy nie tylko koszt jego przechowywania, ale rÃ³wnieÅ¼ przetwarzania.
        Istotne jest jednak Å¼eby zrozumieÄ‡, Å¼e przetwarzanie to tak naprawdÄ™ jakakolwiek forma dostÄ™pu, czyli zapis/odczyt.
    </p>
    <p>
        Poprzez wybÃ³r odpowiedniego formatu pliku, oszczÄ™dnoÅ›ci mogÄ… byÄ‡ naprawdÄ™ spore,
        szczegÃ³lnie kiedy mÃ³wimy o wiÄ™kszej iloÅ›ci danych.
    </p>
    <p>
        Co to w ogÃ³le znaczy, Å¼e Parquet jest formatem binarnym?
    </p>
    <p>
        Oznacza to mniej wiÄ™cej tyle, Å¼e dane przechowywane sÄ… w postaci binarnej, czyli takiej, ktÃ³rej nie da siÄ™
        bezpoÅ›rednio odczytaÄ‡ za pomocÄ… popularnych edytorÃ³w tekstowych.
    </p>
    <p>
        No ale przecieÅ¼ wszystko finalnie przechowywane jest w postaci binarnej, nie?
    </p>
    <p>
        Tak, generalnie pliki tekstowe to teÅ¼ pliki binarne, rÃ³Å¼nica polega na tym, Å¼e w plikach tekstowych struktura
        pliku jest zawsze taka sama i kaÅ¼da informacja zapisywana jest w ten sam sposÃ³b.
    </p>
    <p>
        PrzykÅ‚adowo jeÅ¼eli chcielibyÅ›my zapisaÄ‡ "12345" w pliku tekstowym, wersja binarna bÄ™dzie wyglÄ…daÄ‡ nastÄ™pujÄ…co:
    </p>
    <pre><code class="code-shell" data-controller="syntax-highlight">STRING: &quot;12345&quot;
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Character:   &#039;1&#039;       &#039;2&#039;      &#039;3&#039;      &#039;4&#039;     &#039;5&#039;      &#039;\0&#039;
ASCII:       49        50       51        52     53        0
Binary:    00110001 00110010 00110011 00110100 00110101 00000000
           â””â”€byteâ”€â”˜ â””â”€byteâ”€â”˜ â””â”€byteâ”€â”˜ â””â”€byteâ”€â”˜ â””â”€byteâ”€â”˜ â””â”€byteâ”€â”˜

Total: 6 bytes (including null terminator)</code></pre>
    <p>
        Ten sam ciÄ…g znakÃ³w zapisany w formacie binarnym jako int32 (integer w postaci 32 bitowej) bÄ™dzie wyglÄ…daÄ‡ tak:
    </p>
    <pre><code class="code-shell" data-controller="syntax-highlight">INTEGER: 12345
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Integer:     0         0       48       57
Binary:  00000000  00000000 00110000 00111001
         â””â”€byteâ”€â”˜  â””â”€byteâ”€â”˜ â””â”€byteâ”€â”˜ â””â”€byteâ”€â”˜

Total: 4 bytes for a 32-bit integer</code></pre>

    <p>
        ZauwaÅ¼my, Å¼e w przypadku zapisu integera w formie binarnej, nie da siÄ™ go po prostu odczytaÄ‡ od lewej do prawej (lub odwrotnie).
        Tutaj musimy juÅ¼ wiedzieÄ‡, jak interpretowaÄ‡ te bity, aby zrozumieÄ‡ co one oznaczajÄ….
        W przypadku plikÃ³w tekstowych nie mamy tego problemu, gdyÅ¼ wiemy, Å¼e kaÅ¼dy znak jest zapisywany w postaci 8-bitowej.
    </p>
    <p>
        Mniej wiÄ™cej dlatego dowolny edytor tekstu jest w stanie otworzyÄ‡ kaÅ¼dy plik tekstowy i wyÅ›wietliÄ‡ nam coÅ›, co bÄ™dzie miaÅ‚o mniej lub wiÄ™cej sensu.
    </p>
    <p>
        JeÅ¼eli jednak sprÃ³bujemy otworzyÄ‡ plik typu parquet w edytorze tekstowym, dostaniemy ciÄ…g znakÃ³w wyglÄ…dajÄ…cy bardzo losowo i nie majÄ…cy wiÄ™kszego sensu.
    </p>

    <a href="#columns-rows"><h2 id="columns-rows">Kolumnowy / Wierszowy</h2></a>
    <p>
        Najlepiej rÃ³Å¼nicÄ™ miÄ™dzy tymi formatami wytÅ‚umaczyÄ‡ za pomocÄ… wizualizacji.
    </p>
    <p>
        W klasycznym modelu wierszowym kaÅ¼dy wiersz zawiera wszystkie kolumny, tak jak np. w formacie CSV
    </p>

    <pre><code class="code-shell" data-controller="syntax-highlight">+------+------+------+
| Col1 | Col2 | Col3 |
+------+------+------+
|  A1  |  B1  |  C1  |
|  A2  |  B2  |  C2  |
|  A3  |  B3  |  C3  |
+------+------+------+
</code></pre>

    <p>
        Format kolumnowy jest o tyle ciekawy, Å¼e zamiast przechowywaÄ‡ dane wiersz po wierszu, przechowuje je kolumna po kolumnie.
    </p>

    <pre><code class="code-shell" data-controller="syntax-highlight">+------+------+------+------+
| Col1 |  A1  |  A2  |  A3  |
+------+------+------+------+
| Col2 |  B1  |  B2  |  B3  |
+------+------+------+------+
| Col3 |  C1  |  C2  |  C3  |
+------+------+------+------+
</code></pre>

    <p>
        Przechowywanie danych w formacie kolumnowym przynosi bardzo wiele korzyÅ›ci, takich jak:
    </p>
    <ul>
        <li>DuÅ¼o lepsza moÅ¼liwoÅ›Ä‡ kompresji danych</li>
        <li>MoÅ¼liwoÅ›Ä‡ odczytu tylko wybranych kolumn</li>
        <li>MoÅ¼liwoÅ›Ä‡ szyfrowania wybranych lub wszystkich kolumn</li>
    </ul>

    <p>
        W przypadku formatu wierszowego, aby odczytaÄ‡ tylko jednÄ… kolumnÄ™, musimy i tak przejrzeÄ‡ caÅ‚y plik.<br/>
        W przypadku formatu kolumnowego moÅ¼emy odczytaÄ‡ tylko te kolumny, ktÃ³re nas interesujÄ….<br/>
        Jest to szczegÃ³lnie przydatne w przypadku bardzo duÅ¼ych zbiorÃ³w danych, gdzie czÄ™sto potrzebujemy tylko czÄ™Å›ci informacji.
    </p>


    <a href="#immutable"><h2 id="immutable">Niezmienny</h2></a>
    <p>
        Ze wzglÄ™du na sposÃ³b w jaki dane sÄ… przechowywane w formacie kolumnowym, pliki parquet sÄ… niezmienne.<br/>
        Nie oznacza to jednak, Å¼e nie moÅ¼na ich modyfikowaÄ‡. MoÅ¼na, ale jedyna sensowna operacja to dopisywanie danych na koÅ„cu.
    </p>
    <p>
        Dlaczego? Parquet przechowuje dane w formacie kolumnowym, oznacza to Å¼e jeÅ¼eli mamy kolumnÄ™ <code>email</code>
        to wszystkie wiersze (w danej grupie wierszy i stronie - o tym dalej) bÄ™dÄ… zapisane ciÄ…gniem jeden za drugim. </br>
        PrÃ³ba modyfikacji jednego wiersza jest wiÄ™c niemoÅ¼liwa, poniewaÅ¼ wymagaÅ‚aby przesuniÄ™cia praktycznie caÅ‚ego pliku.
    </p>
    <p>
        MoÅ¼liwe jest natomiast dodanie nowej grupy wierszy na koÅ„cu pliku. Robi siÄ™ to tak, Å¼e z koÅ„cÃ³wki pliku usuwa siÄ™ metadane,
        ktÃ³re tymczasowo trafiajÄ… do pamiÄ™ci. W ich miejsce zapisuje siÄ™ nowÄ… grupÄ™ wierszy (ktÃ³rÄ… teÅ¼ naleÅ¼y dodaÄ‡ do metadanych),
        a nastÄ™pnie na samym koÅ„cu ponownie zapisuje siÄ™ metadane.
    </p>
    <p>
        Z tego wzglÄ™du, jeÅ¼eli chcemy usunÄ…c coÅ› z pliku parqueta, w praktyce musimy przepisaÄ‡ caÅ‚y plik, z pominiÄ™ciem
        niechcianych danych.
    </p>

    <a href="#metadata"><h2 id="metadata">Silna Struktura</h2></a>
    <p>
        Parquet jest formatem opartym o silne typowanie. Oznacza to, Å¼e struktura caÅ‚ego pliku jest zdefiniowana i przechowywana w stopce,
        dziÄ™ki czemu wystarczy odczytaÄ‡ tylko odpowiedni segment aby zrozumieÄ‡ jakie dane mamy w pliku, oraz w ktÃ³rych
        regionach pliku te dane sÄ… zapisane.
    </p>
    <p>
        MoÅ¼emy o tym myÅ›leÄ‡ jak o mapie pliku, mapie, ktÃ³ra powie nam gdzie w pliku dokÅ‚adnie znajdujÄ… siÄ™ dane, ktÃ³re
        nas interesujÄ….
    </p>
    <p>
        Oto jak mniej wiÄ™cej wyglÄ…da uproszczona struktura pliku w formacie parquet:
    </p>
    <pre><code class="code-shell" data-controller="syntax-highlight">+-----------------+
| PAR1            |
+-----------------+
| Data            |
| .............   |
| .............   |
+-----------------+
| File Metadata   |
+-----------------+
| PAR1            |
+-----------------+</code></pre>

    <p>
        Na powyÅ¼szym przykÅ‚adzie widzimy 3 elementy:
    </p>

    <ul>
        <li><code>PAR1</code> - czyli "Parquet Magic Bytes" - 4 bajty otwierajÄ…ce i zamykajÄ…ce pliki w formacie parquet</li>
        <li><code>Data</code> - tutaj zapisane sÄ… wszystkie kolumny (o tym dalej)</li>
        <li><code>Metadata</code> - metadane, czyli mapa pliku</li>
    </ul>

    <p>
        Pierwszym krokiem do poprawnego odczytania pliku parqueta jest sprawdzenie czy pierwsze 4 bajty to <code>PAR1</code>.<br/>
        JeÅ¼eli tak, musimy przeskoczyÄ‡ do koÅ„ca pliku (seek) i odczytaÄ‡ ostatnie 4 bajty.
    </p>
    <p>
        JeÅ¼eli koniec i poczÄ…tek pliku zawierajÄ… <code>PAR1</code> moÅ¼emy przystÄ…piÄ‡ do odczytu metadanych.
    </p>
    <p>
        W tym celu cofamy siÄ™ o 8 bajtÃ³w od koÅ„ca pliku i odczytujemy 4 bajty reprezentujÄ…ce rozmiar metadanych.
        Innymi sÅ‚owy, czytamy bajty <code>-8</code> do <code>-4</code>
    </p>
    <p>
        Te 4 bajty to <code>integer</code> mÃ³wiÄ…cy o tym, na ilu bajtach zapisane sÄ… metadane. MajÄ…c
        tÄ™ informacjÄ™ moÅ¼emy odczytaÄ‡ metadane, ktÃ³re sÄ… zserializowane binarnie za pomocÄ… <a href="https://thrift.apache.org/" target="_blank">Apache Thrift</a>
    </p>
    <a href="#apache-thrift"><h2 id="apache-thrift">Apache Thrift</h2></a>
    <p>
        Apache Thrift to bardzo sprytne narzÄ™dzie pozwalajÄ…ce na binarnÄ… serializacjÄ™ interfejsÃ³w / typÃ³w w praktycznie kaÅ¼dym
        jÄ™zyku programowania.
    </p>
    <p>
        <a href="https://github.com/flow-php/flow/blob/1.x/src/lib/parquet/src/Flow/Parquet/Resources/Thrift/parquet_clean.thrift" target="_blank">Tutaj</a>
        moÅ¼emy zobaczyÄ‡ jak wyglÄ…da definicja metadanych w formacie parquet.
    </p>
    <p>
        Format ten przypomina trochÄ™ pseudokod, ktÃ³ry nastÄ™pnie za pomocÄ… odpowiedniej aplikacji jest uÅ¼yty do wygenerowania
        kodu w danym jÄ™zyku programowania.
    </p>
    <p>
        <a href="https://github.com/flow-php/flow/tree/1.x/src/lib/parquet/src/Flow/Parquet/Thrift" target="_blank">Tutaj</a>
        moÅ¼emy zobaczyÄ‡ jak wyglÄ…da wygenerowany kod w PHP.
    </p>
    <p>
        Kiedy mamy juÅ¼ wygenerowane struktury / interfesy / modele moÅ¼emy przystÄ…piÄ‡ do odczytu.
    </p>

    <pre><code class="code-php" data-controller="syntax-highlight">&lt;?php

use Flow\Parquet\Thrift\FileMetaData;
use Thrift\Protocol\TCompactProtocol;
use Thrift\Transport\TMemoryBuffer;

$metadataLength = \unpack($this-&gt;byteOrder-&gt;value, $this-&gt;stream-&gt;read(4, $fileTotalSize - 8))[1];

$fileMetadata = new FileMetaData();
$fileMetadata-&gt;read(
    new TCompactProtocol(
        new TMemoryBuffer(
            $this-&gt;stream-&gt;read($metadataLength, $fileTotalSize - ($metadataLength + 8))
        )
    )
);</code></pre>

    <p>
        W tym celu bÄ™dzie nam potrzebna biblioteka Thrift dla wybranego jÄ™zyka programowania.
        Wszystkie implementacje dostÄ™pne sÄ… w repozytorium <a href="https://github.com/apache/thrift" target="_blank">apache/thrift</a>.
    </p>

    <p>
        MajÄ…c dostÄ™p do <code>$metadata</code> moÅ¼emy zaczÄ…Ä‡ analizowaÄ‡ nasz plik, aby zrozumieÄ‡ jego strukturÄ™.<br/>
    </p>

    <a href="#parquet-file-metadata"><h2 id="parquet-file-metadata">Parquet - FileMetaData</h2></a>

    <pre><code class="code-shell" data-controller="syntax-highlight">struct FileMetaData {
  1: required i32 version
  2: required list&lt;SchemaElement&gt; schema;
  3: required i64 num_rows
  4: required list&lt;RowGroup&gt; row_groups
  5: optional list&lt;KeyValue&gt; key_value_metadata
  6: optional string created_by
  7: optional list&lt;ColumnOrder&gt; column_orders;
  8: optional EncryptionAlgorithm encryption_algorithm
  9: optional binary footer_signing_key_metadata
}</code></pre>

    <p>
        Kluczowe informacje na temat pliku przechowywane sÄ… w strukturze <code>FileMetaData</code>.
        NajwaÅ¼niejsze z nich to:
    </p>
    <ul>
        <li><code>version</code> - wersja formatu Parquet</li>
        <li><code>num_rows</code> - liczba wierszy w pliku</li>
        <li><code>schema</code> - schemat danych</li>
        <li><code>row_groups</code> - tutaj przechowywane sÄ… nasze dane</li>
    </ul>

    <a href="#format-versions"><h2 id="format-versions">Wersje Formatu</h2></a>
    <p>
        W czasie pisania tego artykuÅ‚u format parquet byÅ‚ juÅ¼ dostÄ™pny w wersji <code>2.12.0</code>.
    </p>
    <p>
        Najbardziej kluczowe zmiany pomiÄ™dzy wersjami 1.0 a 2.0 to:
    </p>
    <ul>
        <li><strong>Nowe schematy kodowania:</strong> DELTA_BINARY_PACKED dla liczb, DELTA_BYTE_ARRAY dla stringÃ³w, RLE_DICTIONARY zastÄ™pujÄ…cy PLAIN_DICTIONARY</li>
        <li><strong>Struktura Data Page V2:</strong> Wyeliminowano narzut metadanych, umoÅ¼liwiono filtrowanie na poziomie stron</li>
    </ul>
    <p>
        Pomimo Å¼e wersja 2.0 wprowadza wiele ulepszeÅ„, to jednak najwiÄ™ksi gracze nadal domyÅ›lnie uÅ¼ywajÄ… wersji 1.
    </p>
    <a href="#rows-count"><h2 id="rows-count">Liczba Wierszy</h2></a>
    <p>
        Ta informacja moÅ¼e na poczÄ…tku wydawaÄ‡ siÄ™ maÅ‚o intuicyjna w kontekÅ›cie formatu kolumnowego.<br/>
        Musimy jednak pamiÄ™taÄ‡, Å¼e format kolumnowy to tylko sposÃ³b przechowywania wartoÅ›ci a nie struktury danych.
    </p>
    <p>
        Pomimo tego, Å¼e dane pogrupowane sÄ… na podstawie kolumn i swojego typu, odczyt/zapis nadal odbywa siÄ™ w klasyczny
        sposÃ³b, czyli wiersz po wierszu.
    </p>
    <p>
        RÃ³Å¼nica polega na tym, Å¼e nie odczytujemy jednego wiersza na raz, a caÅ‚Ä… grupÄ™ wierszy, wczytujÄ…c do pamiÄ™ci
        kolumnÄ™ po kolumnie, a nastÄ™pnie odbudowujÄ…c wiersze na podstawie odpowiednich indeksÃ³w.
    </p>
    <div class="notice">
    <p>
        PamiÄ™tajÄ…c o tym, Å¼e aby odpowiednio zapisywaÄ‡ dane w formacie kolumnowym musimy operowaÄ‡ na logicznych grupach, a nie na pojedynczych wierszach.
        MoÅ¼emy w stosunkowo Å‚atwy sposÃ³b zarzÄ…dzaÄ‡ stosunkiem pamiÄ™ci do iloÅ›ci operacji IO.
    </p>
    </div>
    <p>
        Zapis i odczyt z pamiÄ™ci jest szybszy niÅ¼ zapis i odczyt z dysku (<a href="https://www.bitflux.ai/blog/memory-is-slow-part1/" target="_blank">chociaÅ¼ nie zawsze</a>).
        ZwiÄ™kszajÄ…c iloÅ›Ä‡ wierszy, ktÃ³re bÄ™dÄ… zapisane w jednej grupie, redukujemy iloÅ›Ä‡ grup, czyli iloÅ›Ä‡ operacji IO. <br/>
        Tym samym zwiÄ™kszamy prÄ™dkoÅ›Ä‡ zapisu/odczytu, jednoczeÅ›cie zwiÄ™kszajÄ…c zuÅ¼ycie pamiÄ™ci.
    </p>
    <p>
        DziaÅ‚a to rÃ³wnieÅ¼ w drugÄ… stronÄ™, redukujÄ…c iloÅ›Ä‡ wierszy w grupie, zwiÄ™kszamy iloÅ›Ä‡ grup w pliku, tym samym
        zwiÄ™kszajÄ…c iloÅ›Ä‡ operacji IO.
    </p>
    <p>
        <strong>Rozmiar grupy, nie iloÅ›Ä‡ wierszy</strong> - parquet pozwala definiowaÄ‡ nie iloÅ›Ä‡ wierszy, a maksymalny
        rozmiar grupy wierszy. <br/>
        Jednak naleÅ¼y pamiÄ™taÄ‡, Å¼e nie sÄ… to wartoÅ›ci bezwzglÄ™dne (o tym nieco pÃ³Åºniej), wiÄ™c
        niektÃ³re grupy mogÄ… byÄ‡ mniejsze/wiÄ™ksze niÅ¼ dopuszczalny rozmiar i zaleÅ¼y to gÅ‚Ã³wnie od implementacji biblioteki
        do parqueta.
    </p>
    <p>
        W dokumentacji formatu parquet znajdziemy informacjÄ™, Å¼e sugerowany rozmiar grupy to <code>512Mb - 1Gb</code>.
        Warto jednak podejÅ›Ä‡ do tego z odrobinÄ… rozsÄ…dku, szczegÃ³lnie jeÅ¼eli do odczytu/zapisu nie polegamy na HDFS (Hadoop Distributed File System). <br/>
        Sugerowana wartoÅ›Ä‡ jest ustalona w taki sposÃ³b, aby jedna grupa wierszy mieÅ›ciÅ‚a siÄ™ w jednym bloku HDFS, gwarantujÄ…c, Å¼e odczyt
        odbÄ™dzie siÄ™ z dokÅ‚adnie jednego wÄ™zÅ‚a.
    </p>
    <p>
        Warto o tym pamiÄ™taÄ‡, jeÅ¼eli jednak nie planujemy uÅ¼ywaÄ‡ parqueta z rozproszonym systemem plikÃ³w, mniejsze grupy
        wierszy pozwolÄ… zaoszczÄ™dziÄ‡ sporo pamiÄ™ci.
    </p>
    <p>
        Bardzo dobrym przykÅ‚adem, kiedy mniejsze grupy sÄ… wydajniejsze, jest przypadek, w ktÃ³rym chcielibyÅ›my odczytaÄ‡
        tylko niewielki wycinek wierszy gdzieÅ› z Å›rodka pliku (stronicowanie).
    </p>
    <p>
        ZakÅ‚adajÄ…c, Å¼e musimy odczytaÄ‡ tylko 100 wierszy z pliku, ktÃ³ry zawiera 10 milionÃ³w wierszy, ustawienie mniejszego
        rozmiaru grupy pozwoli zaoszczÄ™dziÄ‡ sporo na pamiÄ™ci. Dlaczego?
    </p>
    <p>
        JeÅ¼eli podzielimy 10 mln na powiedzmy 10 grup, kaÅ¼da grupa zawiera 1 mln wierszy. Oznacza to, Å¼e w praktyce
        musimy odczytaÄ‡ caÅ‚Ä… grupÄ™, a nastÄ™pnie wyciÄ…gnÄ…Ä‡ tylko 100 wierszy, ktÃ³re nas interesujÄ….
    </p>
    <p>
        W przypadku ustalenia mniejszego rozmiaru grupy, ktÃ³ry pozwoli podzieliÄ‡ 10 mln na 1000 grup, analizujÄ…c
        metadane pliku, bÄ™dziemy mogli przeskoczyÄ‡ wiÄ™kszÄ… iloÅ›Ä‡ grup i wczytaÄ‡ do pamiÄ™ci duÅ¼o mniejszÄ… iloÅ›Ä‡ wierszy.
    </p>
    <div class="notice">
    <p>
        Decyzja o rozmiarze grupy wierszy powinna byÄ‡ przemyÅ›lana zarÃ³wno pod kÄ…tem wydajnoÅ›ci zapisu jak i odczytu
        konkretnego pliku. Odpowiednia konfiguracja przekÅ‚ada siÄ™ bezpoÅ›rednio na zuÅ¼ycie zasobÃ³w co finalnie przekÅ‚ada siÄ™
        na pieniÄ…dze.
    </p>
    </div>

    <a href="#schema"><h2 id="schema">Schema</h2></a>

    <p>
        Powoli dochodzimy do sedna parqueta, czyli <code>Row Groups</code>. Zanim jednak przeanalizujemy ich strukturÄ™, musimy
        cofnÄ…Ä‡ siÄ™ do kolejnego bardzo waÅ¼nego aspektu parquet'a, schematu danych.
    </p>

    <p>
        Zacznijmy od typÃ³w danych. Parquet skÅ‚ada siÄ™ z typÃ³w fizycznych i logicznych.
    </p>

    <h3>Physical Types</h3>

    <p>
        Typy fizyczne to podstawowe typy danych, ktÃ³re sÄ… uÅ¼ywane do przechowywania wartoÅ›ci w pliku parquet.
        SÄ… to typy takie jak:
    </p>

    <ul>
        <li>Boolean</li>
        <li>Byte Array</li>
        <li>Double</li>
        <li>Fixed Len Byte Array</li>
        <li>Float</li>
        <li>Int32</li>
        <li>Int64</li>
        <li>Int96 - (deprecated - uÅ¼ywany jedynie przez starsze implementacje)</li>
    </ul>

    <p>
        Typy logiczne to typy, ktÃ³re sÄ… uÅ¼ywane do reprezentowania bardziej zÅ‚oÅ¼onych struktur danych. MoÅ¼na
        o nich myÅ›leÄ‡ jak o rozszerzeniu typÃ³w fizycznych.
    </p>

    <h3>Logical Types</h3>

    <ul>
        <li>Bson</li>
        <li>Date</li>
        <li>Decimal</li>
        <li>Enum</li>
        <li>Integer</li>
        <li>Json</li>
        <li>List</li>
        <li>Map</li>
        <li>String</li>
        <li>Time</li>
        <li>Timestamp</li>
        <li>Uuid</li>
    </ul>

    <p>
        AktualnÄ… strukturÄ™ zawsze moÅ¼na sprawdziÄ‡ u ÅºrÃ³dÅ‚a, <a href="https://github.com/apache/parquet-format/blob/master/src/main/thrift/parquet.thrift" target="_blank">apache/parquet-format</a>
    </p>

    <p>
        Poza podziaÅ‚em na typy logiczne oraz fizyczne parquet rozrÃ³Å¼nia teÅ¼ kolumny pÅ‚askie, oraz zagnieÅ¼dÅ¼one.<br/>
        <strong>Kolumny pÅ‚askie</strong> to takie, ktÃ³re przechowujÄ… pojedynczÄ… wartoÅ›Ä‡, np. <code>Int32</code>, <code>Boolean</code>, <code>Float</code> itp.<br/>
        <strong>Kolumny zagnieÅ¼dÅ¼one</strong> to takie, ktÃ³re przechowujÄ… wiÄ™cej niÅ¼ jednÄ… wartoÅ›Ä‡, np. <code>List</code>, <code>Map</code> itp.
    </p>

    <p>
        W zasadzie istniejÄ… 3 rodzaje kolumn zagnieÅ¼dÅ¼onych:
    </p>
    <ul>
        <li>List</li>
        <li>Map</li>
        <li>Struct</li>
    </ul>
    <p>
        <strong>Struct</strong>, to specjalny typ kolumny, ktÃ³ry pozwala na zagnieÅ¼dÅ¼enie dowolnych innych typÃ³w, pozwalajÄ…c stworzyÄ‡
        praktycznie dowolnÄ… strukturÄ™ danych.
    </p>
    <p>
        Za pomocÄ… powyÅ¼szych typÃ³w jesteÅ›my w stanie zamodelowaÄ‡ praktycznie dowolnÄ…
        strukturÄ™ danych, a nastÄ™pnie efektywnie jÄ… przechowywaÄ‡ i przeszukiwaÄ‡.
    </p>
    <p>
        Popatrzmy wiÄ™c na definicje Thrift <code>SchemaElement</code> oraz kilku powiÄ…zanych elementÃ³w.
    </p>

    <pre><code class="code-shell" data-controller="syntax-highlight">struct SchemaElement {
  1: optional Type type;
  2: optional i32 type_length;
  3: optional FieldRepetitionType repetition_type;
  4: required string name;
  5: optional i32 num_children;
  6: optional ConvertedType converted_type;
  7: optional i32 scale
  8: optional i32 precision
  9: optional i32 field_id;
  10: optional LogicalType logicalType
}

enum FieldRepetitionType {
  REQUIRED = 0;
  OPTIONAL = 1;
  REPEATED = 2;
}

enum Type {
  BOOLEAN = 0;
  INT32 = 1;
  INT64 = 2;
  INT96 = 3;
  FLOAT = 4;
  DOUBLE = 5;
  BYTE_ARRAY = 6;
  FIXED_LEN_BYTE_ARRAY = 7;
}

union LogicalType {
  1:  StringType STRING
  2:  MapType MAP
  3:  ListType LIST
  4:  EnumType ENUM
  5:  DecimalType DECIMAL
  6:  DateType DATE
  7:  TimeType TIME
  8:  TimestampType TIMESTAMP
  10: IntType INTEGER
  11: NullType UNKNOWN
  12: JsonType JSON
  13: BsonType BSON
  14: UUIDType UUID
}</code></pre>

    <p>
        WiÄ™kszoÅ›Ä‡ wartoÅ›ci powinna byÄ‡ w miarÄ™ oczywista, popatrzmy jednak na <code>FieldRepetitionType</code>.
    </p>

    <p>
        Ta wartoÅ›Ä‡ mÃ³wi nam o tym, czy dana kolumna jest wymagana, opcjonalna czy powtarzalna.<br/>
        JeÅ¼eli kolumna jest wymagana, oznacza to, Å¼e wartoÅ›Ä‡ nie moÅ¼e byÄ‡ nullem. <br/>
        JeÅ¼eli kolumna jest opcjonalna wartoÅ›Ä‡ moÅ¼e byÄ‡ nullem, a jeÅ¼eli jest powtarzalna, oznacza to, Å¼e moÅ¼e zawieraÄ‡ wiele wartoÅ›ci (np. listÄ™).
    </p>

    <p>
        Oto jak moÅ¼e wyglÄ…daÄ‡ schemat pliku z zamÃ³wieniami (w postaci DDL)
    </p>

    <pre><code class="code-shell" data-controller="syntax-highlight">message orders_scheme {
    required fixed_len_byte_array(16) order_id (UUID)
    required int64 created_at (TIMESTAMP(MICROS,false))
    optional int64 updated_at (TIMESTAMP(MICROS,false))
    optional float discount
    required binary email (STRING)
    required binary customer (STRING)
    required group address {
          required binary street (STRING);
          required binary city (STRING);
          required binary zip (STRING);
          required binary country (STRING);
    }
    required group notes (LIST) {
          repeated group list {
                required binary element (STRING);
          }
    }
    required group items (LIST) {
          repeated group list {
                required group element {
                      required binary sku (STRING);
                      required int64 quantity (INTEGER(64,true));
                      required float price;
                }
          }
    }
}</code></pre>

    <a href="#nested-types"><h2 id="nested-types">Typy ZagnieÅ¼dÅ¼one</h2></a>

    <p>
        Aby w peÅ‚ni zrozumieÄ‡ strukturÄ™ grup wierszy musimy najpierw zrozumieÄ‡ w jaki sposÃ³b parquet spÅ‚aszcza typy zagnieÅ¼dÅ¼one.<br/>
        O ile proste struktury jak <code>address</code> z powyÅ¼szego przykÅ‚adu moÅ¼na sprowadziÄ‡ w zasadzie do 4 kolumn prostych:
    </p>
    <ul>
        <li><code>address.street</code> - String</li>
        <li><code>address.city</code> - String</li>
        <li><code>address.zip</code> - String</li>
        <li><code>address.country</code> - String</li>
    </ul>
    <p>
        Tak w przypadku <code>Map</code> czy <code>List</code> sytuacja jest trochÄ™ bardziej skomplikowana.
    </p>
    <p>
        PrzykÅ‚adowo, jeÅ¼eli chcielibyÅ›my spÅ‚aszczyÄ‡ <code>Map&lt;string,int32&gt;</code> otrzymamy coÅ› takiego:
    </p>
    <ul>
        <li><code>map_column.key_value.key</code> - String</li>
        <li><code>map_column.key_value.value</code> - Int32</li>
    </ul>
    <p>
        Dla powyÅ¼szego przykÅ‚adu pÅ‚aska Å›cieÅ¼ka do <code>sku</code> bÄ™dzie wyglÄ…daÄ‡ nastÄ™pujÄ…co:
        <code>items.list.element.sku</code>, natomiast spÅ‚aszczona kompletna struktura bÄ™dzie wyglÄ…daÄ‡ tak:
    </p>
    <pre><code class="code-shell" data-controller="syntax-highlight">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Columns â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ path                        â”‚ type                     â”‚ logical type â”‚ repetition â”‚ max repetition â”‚ max definition â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ order_id                    â”‚ FIXED_LEN_BYTE_ARRAY(16) â”‚ UUID         â”‚ REQUIRED   â”‚ 0              â”‚ 0              â”‚
â”‚ created_at                  â”‚ INT64                    â”‚ TIMESTAMP    â”‚ REQUIRED   â”‚ 0              â”‚ 0              â”‚
â”‚ updated_at                  â”‚ INT64                    â”‚ TIMESTAMP    â”‚ OPTIONAL   â”‚ 0              â”‚ 1              â”‚
â”‚ discount                    â”‚ FLOAT                    â”‚ -            â”‚ OPTIONAL   â”‚ 0              â”‚ 1              â”‚
â”‚ email                       â”‚ BYTE_ARRAY               â”‚ STRING       â”‚ REQUIRED   â”‚ 0              â”‚ 0              â”‚
â”‚ customer                    â”‚ BYTE_ARRAY               â”‚ STRING       â”‚ REQUIRED   â”‚ 0              â”‚ 0              â”‚
â”‚ address.street              â”‚ BYTE_ARRAY               â”‚ STRING       â”‚ REQUIRED   â”‚ 0              â”‚ 0              â”‚
â”‚ address.city                â”‚ BYTE_ARRAY               â”‚ STRING       â”‚ REQUIRED   â”‚ 0              â”‚ 0              â”‚
â”‚ address.zip                 â”‚ BYTE_ARRAY               â”‚ STRING       â”‚ REQUIRED   â”‚ 0              â”‚ 0              â”‚
â”‚ address.country             â”‚ BYTE_ARRAY               â”‚ STRING       â”‚ REQUIRED   â”‚ 0              â”‚ 0              â”‚
â”‚ notes.list.element          â”‚ BYTE_ARRAY               â”‚ STRING       â”‚ REQUIRED   â”‚ 1              â”‚ 1              â”‚
â”‚ items.list.element.sku      â”‚ BYTE_ARRAY               â”‚ STRING       â”‚ REQUIRED   â”‚ 1              â”‚ 1              â”‚
â”‚ items.list.element.quantity â”‚ INT64                    â”‚ -            â”‚ REQUIRED   â”‚ 1              â”‚ 1              â”‚
â”‚ items.list.element.price    â”‚ FLOAT                    â”‚ -            â”‚ REQUIRED   â”‚ 1              â”‚ 1              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

    <a href="#row-groups"><h2 id="row-groups">Row Groups</h2></a>

    <pre><code class="code-shell" data-controller="syntax-highlight">+-----------------------------------+
| PAR1                              |
+-----------------------------------+
| Row Group 1                       |
|   +-----------------------------+ |
|   | Column Chunk 1              | |
|   |   (Metadata + Data Pages)   | |
|   +-----------------------------+ |
|   | Column Chunk 2              | |
|   |   (Metadata + Data Pages)   | |
|   +-----------------------------+ |
|   ...                             |
+-----------------------------------+
| Row Group 2                       |
|   +-----------------------------+ |
|   | Column Chunk 1              | |
|   |   (Metadata + Data Pages)   | |
|   +-----------------------------+ |
|   | Column Chunk 2              | |
|   |   (Metadata + Data Pages)   | |
|   +-----------------------------+ |
|   ...                             |
+-----------------------------------+
| ...                               |
+-----------------------------------+
| Metadata                          |
+-----------------------------------+
| PAR1                              |
+-----------------------------------+</code></pre>

    <p>
        Zgodnie z tym co juÅ¼ wiemy, plik parquet podzielony jest na grupy wierszy, zapis do pliku wyglÄ…da w uproszczeniu w taki sposÃ³b:
    </p>
    <ul>
        <li>1) utwÃ³rz plik i dodaj do niego 4 bajty <code>PAR1</code></li>
        <li>2) stwÃ³rz strukturÄ™ metadanych na podstawie schematu i trzymaj jÄ… w pamiÄ™ci</li>
        <li>3) spÅ‚aszcz przekazany wiersz (sprawdzajÄ…c czy pasuje do schematu)</li>
        <li>4) zapisz spÅ‚Ä…szczony wiersz w pamiÄ™ci w postaci binarnej</li>
        <li>
            5) sprawdÅº czy rozmiar grupy wierszy ktÃ³rÄ… aktualnie trzymamy w pamiÄ™ci mieÅ›ci sie w maksymalnym dopuszczalnym rozmiarze
            <ul>
                <li>a) zapisz grupÄ™ wierszy do pliku</li>
                <li>b) zaktualizuj metadane w pamiÄ™ci dodajÄ…c do nich metadane grupy, ktÃ³rÄ… wÅ‚aÅ›nie zapisaliÅ›my</li>
            </ul>
        </li>
        <li>
            6) wrÃ³Ä‡ do kroku 2
        </li>
        <li>
            7) Zapisz metadane na koÅ„cu pliku po zapisaniu wszystkich grup wierszy
        </li>
        <li>
            8) Zamknij plik 4 bajtami <code>PAR1</code>
        </li>
    </ul>
    <div class="notice">
        <p>
            OczywiÅ›cie ten opis jest bardzo uproszczony, w rzeczywistoÅ›ci jest on trochÄ™ bardziej zÅ‚oÅ¼ony, ponadto rÃ³Å¼ne implementacje
            mogÄ… siÄ™ rÃ³Å¼niÄ‡ w szczegÃ³Å‚ach.
        </p>
    </div>

    <p>
        Skupmy siÄ™ na strukturze grupy wierszy, popatrzmy najpierw na definicje Thrift <code>RowGroup</code>.
    </p>

    <pre><code class="code-shell" data-controller="syntax-highlight">struct RowGroup {
  1: required list&lt;ColumnChunk&gt; columns
  2: required i64 total_byte_size
  3: required i64 num_rows
  4: optional list&lt;SortingColumn&gt; sorting_columns
  5: optional i64 file_offset
  6: optional i64 total_compressed_size
  7: optional i16 ordinal
}
</code></pre>

    <p>
        JuÅ¼ na tym etapie widaÄ‡, jak wiele informacji na temat konkretnej grupy wierszy jest przechowywanych w metadanych.<br/>
        Na razie jednak skupmy siÄ™ na trzech polach:
    </p>
    <ul>
        <li><code>file_offset</code> - czyli ile bajtÃ³w od poczÄ…tku pliku naleÅ¼y przeskoczyÄ‡ aby odczytaÄ‡ danÄ… grupÄ™</li>
        <li><code>total_byte_size</code> - na ilu bajtach zapisana jest grupa wierszy</li>
        <li><code>columns</code> - szczegÃ³Å‚owe informacje o kaÅ¼dej kolumnie zapisanej w ramach danej grupy</li>
    </ul>

    <div class="important">
        <p>
            <strong>WaÅ¼ne:</strong> kaÅ¼da grupa wierszy zawiera zawsze wszystkie kolumny zdefiniowane w schemacie.<br/>
            Nawet jeÅ¼eli na przestrzeni caÅ‚ej grupy kolumna zawiera tylko wartoÅ›ci null.
        </p>
    </div>

    <a href="#column-chunks"><h2 id="column-chunks">Column Chunks</h2></a>

    <p>
        WejdÅºmy gÅ‚Ä™biej i przyglÄ…dnijmy siÄ™ definicji Thrift <code>ColumnChunk</code>
    </p>
    <pre><code class="code-shell" data-controller="syntax-highlight">struct ColumnChunk {
  1: optional string file_path
  2: required i64 file_offset
  3: optional ColumnMetaData meta_data
  4: optional i64 offset_index_offset
  5: optional i32 offset_index_length
  6: optional i64 column_index_offset
  7: optional i32 column_index_length
  8: optional ColumnCryptoMetaData crypto_metadata
  9: optional binary encrypted_column_metadata
}

struct ColumnMetaData {
  1: required Type type
  2: required list&lt;Encoding&gt; encodings
  3: required list&lt;string&gt; path_in_schema
  4: required CompressionCodec codec
  5: required i64 num_values
  6: required i64 total_uncompressed_size
  7: required i64 total_compressed_size
  8: optional list&lt;KeyValue&gt; key_value_metadata
  9: required i64 data_page_offset
  10: optional i64 index_page_offset
  11: optional i64 dictionary_page_offset
  12: optional Statistics statistics;
  13: optional list&lt;PageEncodingStats&gt; encoding_stats;
  14: optional i64 bloom_filter_offset;
  15: optional i32 bloom_filter_length;
}
</code></pre>

    <div class="notice">
        <p>
            <strong>PamiÄ™taj:</strong> Wszystko na co do tej pory patrzyliÅ›my to dalej czÄ™Å›Ä‡ metadanych. <br/>
            Oznacza to, Å¼e te wszystkie informacje na temat kolumn, grup wierszy czy samych danych otrzymamy odczytujÄ…c
            tylko i wyÅ‚Ä…cznie koÅ„cÃ³wkÄ™ pliku, niezaleÅ¼nie czy plik ma 1Mb czy 1Tb.
        </p>
    </div>

    <p>
        Tutaj dochodzimy w zasadzie do miejsca pozwalajÄ…cego nam na odczytanie danych z pliku. <br/>
        Zanim jednak to nastÄ…pi musimy poznaÄ‡ ostatniÄ… strukturÄ™ danych niezbÄ™dnÄ… do odczytu.
    </p>

    <a href="#data-pages"><h2 id="data-pages">Data Pages</h2></a>

    <p>
        <code>Pages</code>, czyli kolejny logiczny podziaÅ‚ w strukturz pliku parqueta.<br/>
        <code>Row Group -> Column Chunk -> Data Pages</code>
    </p>

    <ul>
        <li><code>RowGroup</code> - grupa wierszy (partycja)</li>
        <li><code>ColumnChunk</code> - kaÅ¼da grupa wierszy zawiera dokÅ‚adnie 1 <code>ColumnChunk</code> dla kaÅ¼dej kolumny w grupie</li>
        <li><code>Data Page</code> - strona, najmniejsza jednostka logiczna w parquecie agregujÄ…ca dane</li>
    </ul>

    <p>
        Tak naprawdÄ™ odczyt parqueta sprowadza siÄ™ do przeanalizowania struktury metadanych, zlokalizowania adresu poczÄ…tku konkretnej grupy wierszy, nastÄ™pnie
        konkretnej kolumny w grupie, a nastÄ™pnie przeiterowania i odczytania danych z kaÅ¼dej strony.
    </p>

    <p>
        Zanim jednak zaczniemy czytaÄ‡ strony, musimy zrozumieÄ‡ czy mamy do czynienia z <code>DataPage</code>, <code>IndexPage</code> lub <code>DictionaryPage</code>.
    </p>
    <p>
        W tym celu najpierw odczytujemy <code>PageHeader</code> czyli nagÅ‚Ã³wek strony, ktÃ³rego definicja Thrift wyglÄ…da nastÄ™pujÄ…co
    </p>

    <pre><code class="code-shell" data-controller="syntax-highlight">struct PageHeader {
  1: required PageType type
  2: required i32 uncompressed_page_size
  3: required i32 compressed_page_size
  4: optional i32 crc
  5: optional DataPageHeader data_page_header;
  6: optional IndexPageHeader index_page_header;
  7: optional DictionaryPageHeader dictionary_page_header;
  8: optional DataPageHeaderV2 data_page_header_v2;
}

enum PageType {
  DATA_PAGE = 0;
  INDEX_PAGE = 1;
  DICTIONARY_PAGE = 2;
  DATA_PAGE_V2 = 3;
}</code></pre>

    <p>
        Aby odczytaÄ‡ nagÅ‚Ã³wek musimy znaÄ‡ jego adres wzglÄ™dem poczÄ…tku pliku, oto jak moÅ¼emy go obliczyÄ‡ dla wybranej grupy wierszy i wybranej kolumny:
    </p>

    <ol>
        <li>Odczytujemy <code>FileMetadata</code></li>
        <li>Znajdujemy odpowiednia <code>RowGroup</code> i odszukujemy istotny dla nas <code>ColumnChunk</code></li>
        <li>MajÄ…c <code>ColumnChunk</code> otrzymamy adres <code>file_offset</code> poczÄ…tku <code>ColumnChunk</code> wzglÄ™dem poczÄ…tku pliku.</li>
    </ol>

    <div class="important">
        <p>
            <strong>WaÅ¼ne:</strong> Na tym etapie nie musimy jeszcze fizycznie wczytywaÄ‡ do pamiÄ™ci bajtÃ³w.<br/>
            Wystarczy, Å¼e utworzymy <code>stream</code> pozwalajÄ…cy na odczytanie danych bezpoÅ›rednio z pliku.
        </p>
    </div>

    <p>
        PierwszÄ… rzeczÄ… jakÄ… naleÅ¼y odczytaÄ‡ jest nagÅ‚Ã³wek, <code>PageHeader</code>, robiÄ…c to za pomocÄ… Thrifta, przekazujÄ…c
        stream oraz ustawiajÄ…c odpowiednio adres poczÄ…tku otrzymamy strukturÄ™ danych <code>PageHeader</code>, ktÃ³ra powie nam dokÅ‚adnie jak naleÅ¼y odczytaÄ‡
        samÄ… stronÄ™.
    </p>
    <p>
        IstniejÄ… 3 typy stron:
    </p>
    <h3><code>DataPage</code></h3>
    <p>
        Strona zawierajÄ…ca binarnÄ… reprezentacjÄ™ danych wybranej kolumny z wierszy, ktÃ³re trafiÅ‚y do wybranej grupy wierszy.<br/>
        Jest to najprostszy i najbardziej bezpoÅ›redni typ strony. Zawiera "tylko" dane.
    </p>
    <p>
        CzytajÄ…c kolumnÄ™ typu integer, to co nas interesuje to tak naprawdÄ™ liczba wierszy w konkretnej grupie (kaÅ¼dy wiersz to jedna wartoÅ›Ä‡ w <code>DataPage</code>).
        Dlatego wiedzÄ…c, Å¼e w tej grupie mamy powiedzmy 100 wartoÅ›ci, wiemy Å¼e musimy odczytaÄ‡ 400 bajtÃ³w (int32 zapisany jest na 4 bajtach). <br/>
    </p>
    <p>
        No dobra, ale co w przypadku kiedy kolumna jest opcjonalna? To znaczy, Å¼e moÅ¼e zawieraÄ‡ wartoÅ›ci null.<br/>
        Tutaj sytuacja robi siÄ™ trochÄ™ bardziej skomplikowana poniewaÅ¼ musimy wiedzieÄ‡, ktÃ³re wiersze zawierajÄ… wartoÅ›Ä‡ null.<br/>
        SkÄ…d ta wiedza zapytacie? <br/>
        <code>Definition Levels</code>
    </p>
    <p>
        Sytuacja siÄ™ trochÄ™ komplikuje, na poczÄ…tku pisaÅ‚em, Å¼e <code>DataPage</code> zawiera tylko dane, a teraz dokÅ‚adam jakieÅ› <code>Definition Levels</code>.<br/>
    </p>
    <p>
        W rzeczywistoÅ›ci struktura data page wyglÄ…da mniej wiÄ™cej tak:
    </p>
    <pre><code class="code-shell" data-controller="syntax-highlight">Parquet Data Page: int32
=======================================
[ Repetition Levels ]: 0, 0, 0, 0, 0
---------------------------------------
[ Definition Levels ]: 1, 0, 1, 1, 0
---------------------------------------
[ Values           ]: 42, 73, 19
=======================================
</code></pre>
    <p>
        Na ten moment, skupmy siÄ™ tylko na <code>Definition Levels</code> i <code>Values</code>. Bardzo Å‚atwo zauwaÅ¼yÄ‡ zwiÄ…zek miÄ™dzy nimi.
        IloÅ›Ä‡ <code>Definition Level</code> i <code>Repetition Levels</code> w kaÅ¼dej stronie jest zawsze rÃ³wna iloÅ›ci wartoÅ›ci w kolumnie.<br/>
        Bez wzglÄ™du na to czy sÄ… tam nulle czy nie. <code>Definition Levels</code> mÃ³wiÄ… nam czy dany wiersz zawiera wartoÅ›Ä‡ czy null.
    </p>
    <p>
        Na tej podstawie, moÅ¼emy Å‚atwo okreÅ›liÄ‡ caÅ‚kowitÄ… iloÅ›Ä‡ nie pustych <code>Values</code> co pozwoli nam na ich odczyt. <br/>
        W powyÅ¼szym przykÅ‚adzie mamy 5 wierszy, z czego 3 stanowiÄ… wartoÅ›ci, poniewaÅ¼ <code>int32</code> zapisujemy na 4 bajtach,
        wiemy juÅ¼ Å¼e musimy odczytaÄ‡ w sumie 12 bajatÃ³w.<br/>
        Wiemy teÅ¼, Å¼e przeksztaÅ‚cajÄ…c kolumnÄ™ na wiersze, wiersz pierwszy bÄ™dzie zawieraÅ‚ wartoÅ›Ä‡ <code>42</code>, wiersz drugi <code>null</code>,
        wiersz trzeci <code>73</code>, wiersz czwarty <code>19</code> i wiersz piÄ…ty <code>null</code>.
    </p>
    <div class="important">
        <p>
            <strong>WaÅ¼ne:</strong> <code>Repetition Levels</code> i <code>Definition Levels</code> sÄ… jednak o wiele bardziej skomplikowane, nieco wiÄ™cej pÃ³Åºniej.<br/>
        </p>
    </div>
    <p>
        Tak mniej wiÄ™cej prezentuje siÄ™ struktura <code>DataPage</code>.
    </p>
    <h3><code>DictionaryPage</code></h3>
    <p>
        Skoro dane trzymamy w <code>DataPage</code>, jaki cel ma <code>DictionaryPage</code>?<br/>
        OtÃ³Å¼ <code>DictionaryPage</code> to strona zawierajÄ…ca sÅ‚ownik wartoÅ›ci.<br/>
        SÅ‚ownik, uÅ¼ywany do odczytywania danych, szczegÃ³lnie w przypadku kolumn zawierajÄ…cych powtarzalne wartoÅ›ci.
    </p>

    <p>
        DziaÅ‚a to mniej wiÄ™cej tak, Å¼e odczytujÄ…c <code>ColumChunk</code>, zaczynamy od pierwszej strony, jeÅ¼eli ta strona to <code>DictionaryPage</code>,
        wiemy Å¼e mamy do czynienia z sÅ‚ownikiem (w zasadzie wiemy to od poczÄ…tku, poniewaÅ¼ jest to zapisane w metadanych kolumny).
    </p>
    <p>
        JeÅ¼eli przykÅ‚adowo odczytujemy kolumnÄ™ o wysokiej powtarzalnoÅ›ci, np. kolumnÄ™ z nazwÄ… kraju, zamiast zapisywaÄ‡ w <code>DataPage</code> peÅ‚nÄ… nazwÄ™ kraju dla kaÅ¼dego wiersza,
        zapisujemy jedynie jej pozycjÄ™ w sÅ‚owniku.<br/>
        W przypadku takiej kolumny pierwsza strona w kolumnie bÄ™dzie <code>DictionaryPage</code>, a kolejne bÄ™dÄ… <code>DataPage</code>.
    </p>
    <p>
        RÃ³Å¼nica polega na tym, Å¼e w <code>DataPage</code> zamiast peÅ‚nej wartoÅ›ci, bÄ™dÄ… znajdowaÄ‡ siÄ™ pozycje w sÅ‚owniku, ktÃ³ry bÄ™dziemy trzymaÄ‡ w pamiÄ™ci w celu odbudowania wierszy.<br/>
    </p>
    <div class="important">
        <p>
            <strong>WaÅ¼ne:</strong> KaÅ¼dy <code>ColumnChunk</code> moÅ¼e zawieraÄ‡ tylko jednÄ… stronÄ™ <code>DictionaryPage</code>.
        </p>
    </div>
    <p>
        Potrafi to daÄ‡ ogromne oszczÄ™dnoÅ›ci, zamiast powiedzmy zapisywaÄ‡ binarnie sÅ‚owo <code>Polska</code> 10 tys. razy, czyli 60k bajtÃ³w,
        zapiszemy tylko pozycjÄ™ w indeksie (czyli 4 bajty), ktÃ³re dodatkowo zostanÄ… spakowane za pomocÄ… algorytmu <a href="https://parquet.apache.org/docs/file-format/data-pages/encodings/#RLE" target="_blank">Run Length Encoding / Bit-Packing Hybrid</a>.
        KtÃ³ry, rÃ³wnieÅ¼ opierajÄ…c siÄ™ na powtarzalnoÅ›ci kolejnych wartoÅ›ci zredukuje caÅ‚kowitÄ… iloÅ›Ä‡ potrzebnych bajtÃ³w.
    </p>

    <h3><code>IndexPage</code></h3>
    <p>
        Ostatnim juÅ¼ typem strony, jest <code>IndexPage</code>.<br/>
        Strona ta nie zawiera danych, nie jest wiÄ™c niezbÄ™dna do odczytu ani zapisu.<br/>
        KaÅ¼dy <code>ColumnChunk</code> moÅ¼e zawieraÄ‡ tylko jednÄ… stronÄ™ typu <code>IndexPage</code> i znajduje siÄ™ ona zawsze na koÅ„cu, po <code>DictionaryPage</code> oraz wszystkich <code>DataPage</code>.
    </p>
    <p>
        Celem tej strony jest przechowywanie statystyk odnoÅ›nie <code>ColumnChunk</code>, jak np. wartoÅ›ci <code>Min/Max</code>, iloÅ›Ä‡ <code>nulli</code> czy sposÃ³b sortowania dla kaÅ¼dej strony w konkretnym <code>ColumnChunk</code>.
        Pozwala to na szybkie filtrowanie oraz odnajdywanie konkretnych tylko konkretnych stron w ramach danego <code>ColumnChunka</code>, co znaczÄ…co przyÅ›piesza przeszukiwanie pliku, jeÅ¼eli interesujÄ… nas konkretne informacje.
    </p>
    <div class="notice">
        <p>
            <strong>Uwaga:</strong> KaÅ¼dy <code>ColumnChunk</code> w swoich metadanych zawiera podobne statystyki co <code>IndexPage</code>, jednak nie dla kaÅ¼dej strony a dla caÅ‚ego <code>ColumnChunk</code>.<br/>
            DziÄ™ki temu, w pierwszej kolejnoÅ›ci moÅ¼emy przeskoczyÄ‡ caÅ‚e kolumny, ktÃ³re nas nie interesujÄ… a nastÄ™pnie nawet konkretne strony, redukujÄ…c do absolutnego minimum iloÅ›Ä‡ danych, ktÃ³re musimy odczytaÄ‡.
        </p>
    </div>

    <p>
        BiorÄ…c pod uwagÄ™, Å¼e te informacje znajdujÄ… siÄ™ w metadanych pliku, nawet najwiÄ™ksze pliki parqueta, mogÄ… byÄ‡ bÅ‚yskawicznie odczytywane i filtrowane nawet jeÅ¼eli sÄ… one tylko dostÄ™pne przez sieÄ‡.<br/>
        Wystarczy, Å¼e uda siÄ™ nam odczytaÄ‡ metadane, na ich podstawie zlokalizowaÄ‡ konkretnÄ… grupÄ™ wierszy, nastÄ™pnie wybranÄ… kolumnÄ™ a na koÅ„cu konkretne strony. <br/>
        Dostaniemy w ten sposÃ³b bardzo precyzyjnÄ… lokalizacjÄ™ naszych danych, ktÃ³re bÄ™dziemy mogli odczytaÄ‡ za pomocÄ… nagÅ‚Ã³wka <code>Http Range Header</code>.
    </p>
    <p>
        To wÅ‚aÅ›nie jeden z powodÃ³w, dla ktÃ³rych parquet jest tak potÄ™Å¼ny, nie mÃ³wimy juÅ¼ tutaj o brutalnym pobieraniu i iterowaniu po gigabajtowym pliku. Parquet pozwala z precyzjÄ… chirurga
        pobraÄ‡ i odczytaÄ‡ tylko te obszary pliku, ktÃ³re naprawdÄ™ nas interesujÄ….
    </p>

    <a href="#dremel"><h2 id="dremel">Dremel</h2></a>

    <p>
        OmawiajÄ…c strukturÄ™ <code>DataPage</code> wspomniaÅ‚em o <code>Definition Levels</code> oraz <code>Repetition Levels</code>.
    </p>
    <p>
        OmÃ³wiony przykÅ‚ad byÅ‚ bardzo prosty, poniewaÅ¼ dotyczyÅ‚ kolumny prostej (int32), przez co <code>Repetition Levels</code> w ogÃ³le nie majÄ… zastosowania.<br/>
        Sytuacja zmienia siÄ™ diametralnie, kiedy mamy do czynienia z kolumnÄ… zagnieÅ¼dÅ¼onÄ…, np. strukturÄ…, listÄ… czy mapÄ….
        SpÃ³jrzmy na przykÅ‚ad.
    </p>
    <p>
        <code>[{"sku":"abc", "quantity": 1, "price": 100}, {"sku":"def", "quantity": 2, "price": 200}]</code>
    </p>
    <p>
        WracajÄ…c do wczeÅ›niejszej czÄ™Å›ci tego artykuÅ‚u, a dokÅ‚adnie do <a href="#nested-types">typÃ³w zagnieÅ¼dÅ¼onych</a>.<br/>
        Wiemy, Å¼e nasze dane po spÅ‚aszczeniu bÄ™dÄ… wyglÄ…daÄ‡ nastÄ™pujÄ…co:
    </p>
    <ul>
        <li><code>items.list.element.sku</code> - <code>"abc","def"</code></li>
        <li><code>items.list.element.quantity</code> - <code>1,2</code></li>
        <li><code>items.list.element.price</code> - <code>100,200</code></li>
    </ul>
    <p>
        Mamy tutaj do czynienia z 3 kolumnami, kaÅ¼da z nich bÄ™dzie znajdowaÄ‡ siÄ™ w osobnym <code>Column Chunk</code> i kaÅ¼da bÄ™dzie zawieraÄ‡
        w sobie jednÄ… lub wiÄ™cej stron.
    </p>
    <p>
        SkÄ…d wiÄ™c na podstawie tych dwÃ³ch wartoÅ›ci (<code>Repetition / Definition Levels)</code> biblioteki czytajÄ…ce pliki wiedzÄ…, jak gÅ‚Ä™boko w strukturze znajdujÄ… siÄ™ wartoÅ›ci oraz do ktÃ³rego elementu one naleÅ¼Ä…?<br/>
        Co w przypadku, gdyby nasza struktura wyglÄ…daÅ‚a tak:
    </p>
    <p>
        <code>[{"sku":"abc", "quantity": 1, "price": 100}, {"sku":null, "quantity": 10, "price": 100}, {"sku":"def", "quantity": 2, "price": 200}]</code>
        (w drugim elemencie sku ma wartoÅ›Ä‡ null). <br/>
    </p>
    <p>Co w przypadku, kiedy struktura jest o wiele bardziej zagnieÅ¼dÅ¼ona, skÄ…d mamy wiedzieÄ‡, ktÃ³ra wartoÅ›Ä‡ wpada na ktÃ³ry poziom zagnieÅ¼dÅ¼enia?</p>
    <p>
        Na to oraz wiele innych pytaÅ„ odpowiedÅº znajdziemy w dokumencie opublikowanym przez Google <a href="https://static.googleusercontent.com/media/research.google.com/pl//pubs/archive/36632.pdf" target="_blank">Dremel: Interactive Analysis of Web-Scale Datasets</a>
        ktÃ³ry opisuje, w jaki sposÃ³b Google przechowuje oraz przeszukuje zagnieÅ¼dÅ¼one struktury danych.
    </p>
    <p>
        NarzÄ™dzie wykorzystywane przez Googla nazywa siÄ™ Dremel i jest rozproszonym systemem przeszukiwania duÅ¼ych zbiorÃ³w danych. <br/>
        Opiera siÄ™ ono na 2 algorytmach, <code>Shredding</code> oraz <code>Assembling</code>, ktÃ³re zostaÅ‚y opisane bardzo pobieÅ¼nie w powyÅ¼szym dokumencie.
    </p>
    <div class="notice">
        <p>
            <strong>Uwaga:</strong> Opisanie dokÅ‚adnego dziaÅ‚ania tych algorytmÃ³w wykracza poza ramy tego i tak dÅ‚ugiego wpisu.<br/>
            JeÅ¼eli jednak pojawi siÄ™ zainteresowanie tematem, postaram siÄ™ poruszyÄ‡ rÃ³wnieÅ¼ i ten wÄ…tek w nadchodzÄ…cych wpisach.
        </p>
    </div>
    <p>
        Algorytmy te bazujÄ… na tych 3 definicjach:
    </p>
    <ul>
        <li>Repetition Levels</li>
        <li>Definition Levels</li>
        <li>Values</li>
    </ul>
    <p>
        Tak jak juÅ¼ wspominaliÅ›my <code>Definition Level</code> okreÅ›la czy dany wiersz zawiera wartoÅ›Ä‡, czy teÅ¼ nie, <code>Repetition Level</code> ktÃ³ry w przypadku kolumn pÅ‚askich jest zawsze 0.
        Dla struktur okreÅ›laÄ‡ bÄ™dzie czy wartoÅ›Ä‡ (lub null) ma byÄ‡ powtÃ³rzona, oraz na ktÃ³rym poziomie zagÅ‚Ä™bienia.
    </p>
    <div class="notice">
        <p>
            <strong>Uwaga:</strong> Wiedza o tym, jak dokÅ‚adnie dziaÅ‚ajÄ… algorytmy z Dremela, nie jest niezbÄ™dna do optymalnego wykorzystywania parqueta.
            Z tego powodu, nie bÄ™dÄ™ siÄ™ na ten temat rozpisywaÅ‚, jeÅ¼eli jednak pojawi siÄ™ zainteresowanie tematem, postaram siÄ™ poruszyÄ‡ rÃ³wnieÅ¼ i ten wÄ…tek w nadchodzÄ…cych wpisach.
        </p>
    </div>
    <p>
         PoniÅ¼ej przedstawiÄ™ tylko mniej wiÄ™cej, jak wyglÄ…daÄ‡ bÄ™dÄ… spÅ‚aszczone dane.
    </p>
    <pre>
        <code class="code-shell" data-controller="syntax-highlight">Input:
[
    &#039;items&#039; =&gt; [
        [&#039;sku&#039; =&gt; &#039;abc&#039;, ...],
        [&#039;sku&#039; =&gt; &#039;def&#039;, ...],
    ]
]

Output:
{
  [&quot;sku&quot;] =&gt;
  {
    [&quot;repetition_levels&quot;] =&gt; { [0] =&gt; int(0) [1] =&gt; int(1) }
    [&quot;definition_levels&quot;] =&gt; { [0] =&gt; int(1) [1] =&gt; int(1) }
    [&quot;values&quot;] =&gt; { [0] =&gt; string(3) &quot;abc&quot; [1] =&gt; string(3) &quot;def&quot; }
  }
}</code>
    </pre>
    <p>
        Czyli w rzeczywistoÅ›ci zapisujemy <code>0, 1, 0, 1, "abc", "def"</code> a nie tylko <code>"abc", "def"</code>. <br/>
        To wÅ‚aÅ›nie te dodatkowe liczby mÃ³wiÄ… w jaki sposÃ³b odbudowaÄ‡ dowolnÄ… strukturÄ™ zagnieÅ¼dÅ¼onÄ….
    </p>
    <p>
        CiekawostkÄ… jest, Å¼e nawet repetition levels i definition levels w celu optymalizacji sÄ… wczeÅ›nie odpowiednio pakowane przy uÅ¼yciu algorytmu
        <a href="https://parquet.apache.org/docs/file-format/data-pages/encodings/#RLE" target="_blank">Run Length Encoding / Bit-Packing Hybrid</a>.
    </p>
    <p>
        Na tym nie koniec, bo nie tylko poziomy sÄ… pakowane, ale rÃ³wnieÅ¼ same wartoÅ›ci.<br/>
        W zaleÅ¼noÅ›ci od typu kolumny, wartoÅ›ci mogÄ… byÄ‡ pakowane na rÃ³Å¼ne sposoby, listÄ™ wszystkich algorytmÃ³w pakujÄ…cych obsÅ‚ugiwanych przez parqueta (przynajmniej w teorii) znajdziemy
        <a href="https://parquet.apache.org/docs/file-format/data-pages/encodings" target="_blank">w oficjalnej dokumentacji</a>.
    </p>
    <p>
        Natomiast informacjÄ™ o tym, jaki algorytm zostaÅ‚ uÅ¼yty do spakowania danych przed zapisem znajdziemy w metadanych, pod takÄ… Å›cieÅ¼kÄ… <code>RowGroups[x].ColumnChunk[y].PageHeader[z].data_page_header.encoding</code>
    </p>
    <p>
        Nie jest to natomiast ostatnie sÅ‚owo parqueta w kontekÅ›cie optymalizacji!
    </p>
    <a href="#compression"><h2 id="compression">Kompresja</h2></a>
    <p>
        Po spakowaniu i zapisaniu w formie binarnej naszych danych dla konkretnej strony, kaÅ¼da strona jest dodatkowo kompresowana.
    </p>
    <p>
        W zaleÅ¼noÅ›ci od implementacji parquet pozwala na uÅ¼ycie rÃ³Å¼nych algorytmÃ³w kompresji:
    </p>
    <ul>
        <li>UNCOMPRESSED</li>
        <li>SNAPPY</li>
        <li>GZIP</li>
        <li>LZO</li>
        <li>BROTLI</li>
        <li>LZ4</li>
        <li>ZSTD</li>
        <li>LZ4_RAW</li>
    </ul>
    <p>
        Bardzo popularnÄ… opcjÄ… jest <a href="https://github.com/google/snappy" target="_blank">Snappy</a>, ktÃ³ra oferuje bardzo dobry kompromis pomiÄ™dzy szybkoÅ›ciÄ… a stopniem kompresji.
    </p>
    <p>
        NarzÄ™dzia takie jak <a href="https://spark.apache.org/" target="_blank">Apache Spark</a> wrÄ™cz uÅ¼ywajÄ… go domyÅ›lnie.
    </p>
    <a href="#encryption"><h2 id="encryption">Szyfrowanie</h2></a>
    <p>
        JednÄ… z ostatnich ciekawszych funkcji, ktÃ³rÄ… chciaÅ‚bym omÃ³wiÄ‡, jest szyfrowanie!
    </p>
    <p>
        Tak, parquet pozwala szyfrowaÄ‡ dane, szyfrowaÄ‡ na wielu poziomach.
    </p>
    <ul>
        <li>Metadane - zaszyfrowane metadane skutecznie utrudniajÄ… odczytanie zawartoÅ›ci pliku, jednak nie jest to niemoÅ¼liwe</li>
        <li>Dane - zaszyfrowane dane praktycznie uniemoÅ¼liwiajÄ… odczyt</li>
        <li>Kolumny - szczegÃ³lnie przydatne, jeÅ¼eli tylko niektÃ³re kolumny zawierajÄ… wraÅ¼liwe dane.</li>
        <li>Strony</li>
    </ul>
    <div class="notice">
        <p>
            <strong>Uwaga:</strong> Szyfrowanie jest jednÄ… z tych, funkcji, ktÃ³rych jeszcze nie zdÄ…Å¼yÅ‚em pokryÄ‡ w <a href="https://flow-php.com/documentation/components/libs/parquet/">implementacji dla PHP</a><br/>
            Z tego powodu nie bÄ™dÄ™ siÄ™ na ten temat rozpisywaÅ‚, jak tylko nadaÅ¼y siÄ™ okazja do zaimplementowanie tej funkcjonalnoÅ›ci, postaram siÄ™ uzupeÅ‚niÄ‡ artykuÅ‚.
        </p>
    </div>
    <p>
        Szyfrowanie w parquecie opiera siÄ™ o <a href="https://parquet.apache.org/docs/file-format/data-pages/encryption/" target="_blank">Parquet Modular Encryption</a> i wykorzystuje
        <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197.pdf" target="_blank">AES</a> do szyfrowania danych.
    </p>
    <p>
        Szyfrowanie, szczegÃ³lnie wybranych kolumn, wynosi parqueta na wyÅ¼szy poziom przechowywania danych. <br/> DziÄ™ki temu w stosunkowo Å‚atwy sposÃ³b, z niewielkim narzutem,
        moÅ¼emy dodatkowo zabezpieczyÄ‡ dane, ktÃ³re przechowujemy w plikach parqueta. <br/>
    </p>
    <p>
        WyobraÅºmy sobie, Å¼e parquet jest uÅ¼ywany do przechowywania danych klientÃ³w, gdzie kolumna <code>email</code> oraz <code>phone</code> zawierajÄ… dane wraÅ¼liwe.<br/>
        W tej sytuacji, aÅ¼ siÄ™ prosi o to, Å¼eby te dwie kolumny byÅ‚y dodatkowo zabezpieczone. Nawet jeÅ¼eli komuÅ› uda siÄ™ uzyskaÄ‡ fizyczny dostÄ™p do pliku, bez klucza i tak nie
        bÄ™dzie w stanie odczytaÄ‡ danych.
    </p>
    <a href="#summary"><h2 id="summary">Podsumowanie</h2></a>
    <p>
        To wÅ‚aÅ›nie jest tajemnica parqueta i sposÃ³b na wydajnoÅ›Ä‡. Zamiast przechowywaÄ‡ dowolne dane w postaci tekstowej, parquet idzie o kilka krokÃ³w dalej. <br/>
        W pierwszej kolejnoÅ›ci wymusza schemat danych opierajÄ…cy siÄ™ o proste lecz niesamowicie elastyczne typy, z ktÃ³rych kaÅ¼dy da siÄ™
        przedstawiÄ‡ w postaci binarnej.<br/>
        NastÄ™pnie postaÄ‡ binarna jest odpowiednio pakowana, tak aby unikaÄ‡ zbÄ™dnych powtÃ³rzeÅ„ bajtÃ³w, co na samym koÅ„cu jest
        jeszcze dodatkowo kompresowane za pomocÄ… bardzo wydajnych algorytmÃ³w.<br/>
        WisienkÄ… na torcie sÄ… zaawansowane i szczegÃ³Å‚Ã³we metadane, dostÄ™pne na kilku poziomach, pozwalajÄ…ce odfiltrowaÄ‡
        zbÄ™dne partycje, lub wrÄ™cz caÅ‚e pliki bez odczytywania ich zawartoÅ›ci.
    </p>
    <p>
        Ponadto dziÄ™ki odpowiedniemu podziaÅ‚owi logicznemu, nad ktÃ³rym mamy peÅ‚nÄ… kontrolÄ™ (rozmiar grup i stron) moÅ¼emy
        decydowaÄ‡ co jest dla nas waÅ¼niejsze, szybkoÅ›Ä‡ czy oszczÄ™dnoÅ›Ä‡ pamiÄ™ci. Przeszukiwanie czy odczytywanie danych a moÅ¼e
        bezpieczeÅ„stwo, do ktÃ³rego wykorzystamy dodatkowe szyfrowanie?
    </p>
    <p>
        Parquet to naprawdÄ™ potÄ™Å¼ne narzÄ™dzie, ktÃ³re w odpowiednich rÄ™kach pozwala na efektywne przechowywanie i przeszukiwanie
        ogromnych iloÅ›ci danych.<br/>
    </p>
    <p>
        JeÅ¼eli ten wpis zainspirowaÅ‚ CiÄ™ do poeksperymentowania z tym rewelacyjnym formatem danych, daj znaÄ‡ w komentarzach!
    </p>
    <a href="#help"><h2 id="help">Pomoc</h2></a>
    <p>
        JeÅ›li potrzebujesz pomocy w zakresie budowy centralnego magazynu danych, chÄ™tnie Ci pomogÄ™.<br/>
        <a href="https://norbert.tech/consulting">Skontaktuj siÄ™ ze mnÄ…</a>, a wspÃ³lnie stworzymy rozwiÄ…zanie, ktÃ³re bÄ™dzie idealnie dopasowane do Twoich potrzeb.
    </p>
    <p>
        ZachÄ™cam rÃ³wnieÅ¼ do odwiedzenia serwera <a href="https://discord.gg/5dNXfQyACW" target="_blank">Discord - Flow PHP</a>, na ktÃ³rym
        moÅ¼emy porozmawiaÄ‡ bezpoÅ›rednio.
    </p>
    <div class="img-wide">
        <img src="https://norbert.tech/assets/images/blog/analytics-in-transactional-distributed-systems/consulting_01-fa277dfb3736a033cbfcf1ac931afb08.jpg" alt="Konsultacje" />
    </div>

    </article>
    <div class="mb-2 mx-auto max-w-screen-lg text-center">
        <script src="https://giscus.app/client.js"
                data-repo="norberttech/norbert.tech"
                data-repo-id="MDEwOlJlcG9zaXRvcnkyMjQ0MDQwNDA="
                data-category="Comments"
                data-category-id="DIC_kwDODWAiSM4CionD"
                data-mapping="pathname"
                data-strict="0"
                data-reactions-enabled="0"
                data-emit-metadata="0"
                data-input-position="bottom"
                data-theme="light"
                data-lang="en"
                crossorigin="anonymous"
                async>
        </script>
    </div>
    </main>

    <footer class="p-4 bg-sky-50 absolute bottom-0 w-full">
        <div class="mx-auto max-w-screen-2xl text-center">
            <a href="/">by @norbert_tech</a>
        </div>
    </footer>
</body>
</html>