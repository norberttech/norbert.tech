<!doctype html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Analyse de donn√©es dans les syst√®mes transactionnels distribu√©s</title>
    <meta property="og:title" content="Analyse de donn√©es dans les syst√®mes transactionnels distribu√©s" />
    <meta name="twitter:title" content="Analyse de donn√©es dans les syst√®mes transactionnels distribu√©s" >

    <meta name="description" content="Votre syst√®me transactionnel s&#039;effondre sous le poids des rapports ? Vous cherchez un moyen de construire une source de donn√©es unifi√©e pour votre syst√®me distribu√© ? D√©couvrez comment commencer √† construire un entrep√¥t de donn√©es analytiques efficace et √©viter les pi√®ges courants.">
    <meta property="og:description" content="Votre syst√®me transactionnel s&#039;effondre sous le poids des rapports ? Vous cherchez un moyen de construire une source de donn√©es unifi√©e pour votre syst√®me distribu√© ? D√©couvrez comment commencer √† construire un entrep√¥t de donn√©es analytiques efficace et √©viter les pi√®ges courants.">
    <meta name="twitter:description" content="Votre syst√®me transactionnel s&#039;effondre sous le poids des rapports ? Vous cherchez un moyen de construire une source de donn√©es unifi√©e pour votre syst√®me distribu√© ? D√©couvrez comment commencer √† construire un entrep√¥t de donn√©es analytiques efficace et √©viter les pi√®ges courants.">

    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://norbert.tech/blog/2025-08-12/fr/analyse-donnees-systemes-transactionnels-distribues" />
                <meta property="og:image" content="https://norbert.tech/assets/images/blog/analytics-in-transactional-distributed-systems/analytics_01-b27f8a842f645a9c7d9901f3fd11fde8.jpg" />
                    
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://norbert.tech/blog/2025-08-12/fr/analyse-donnees-systemes-transactionnels-distribues" />
    <meta name="twitter:image" content="https://norbert.tech/assets/images/avatar-8f3c52c37f20d07c5e1631e1512bdeca.jpeg">
    <meta name="twitter:site" content="@norbert_tech" />
    <meta name="twitter:creator" content="@norbert_tech" />

    <link rel="apple-touch-icon" sizes="180x180" href="https://norbert.tech/assets/images/favicons/apple-touch-icon-9cae7ee880b4fe0bd755d300e1bca71e.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://norbert.tech/assets/images/favicons/favicon-32x32-b7a4ad4b584ab95534144e071f0e8587.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://norbert.tech/assets/images/favicons/favicon-16x16-154ca21abc06ae116c8d7ffc5713c000.png">
    <link rel="shortcut icon" href="https://norbert.tech/assets/images/favicons/favicon-db409885df78dea389e6d0b036da382c.ico">

            <style>
            @import url('https://fonts.googleapis.com/css2?family=Cabin:ital,wght@0,400..700;1,400..700&display=swap');
        </style>
        <link rel="stylesheet" href="https://norbert.tech/assets/styles/app-b77c10652c9d788af79436d910fc3bc2.css">
    
            
<script type="importmap">
{
    "imports": {
        "app": "https://norbert.tech/assets/app-930adf3462cf9ab60908eb1b74cf7ca7.js",
        "@oddbird/popover-polyfill": "https://norbert.tech/assets/vendor/@oddbird/popover-polyfill/popover-polyfill.index-7979d53637476aa204f709644aed2c19.js",
        "https://norbert.tech/assets/bootstrap.js": "https://norbert.tech/assets/bootstrap-d78d7e12c819dedf89372fb4824c072d.js",
        "htmx.org": "https://norbert.tech/assets/vendor/htmx.org/htmx.org.index-023ae86a082913526422a6063298f898.js",
        "iconify-icon": "https://norbert.tech/assets/vendor/iconify-icon/iconify-icon.index-8a41e423576dc2d752509fd455f508c1.js",
        "@symfony/stimulus-bundle": "https://norbert.tech/assets/@symfony/stimulus-bundle/loader-5751ad1ee2975e725a94d8121d153d17.js",
        "@hotwired/stimulus": "https://norbert.tech/assets/vendor/@hotwired/stimulus/stimulus.index-304681764684182e6662e0931532ed91.js",
        "https://norbert.tech/assets/@symfony/stimulus-bundle/controllers.js": "https://norbert.tech/assets/@symfony/stimulus-bundle/controllers-11c35dc7f11bbd855b8108888f18f9b7.js",
        "https://norbert.tech/assets/controllers/hello_controller.js": "https://norbert.tech/assets/controllers/hello_controller-55882fcad241d2bea50276ea485583bc.js",
        "https://norbert.tech/assets/controllers/syntax_highlight_controller.js": "https://norbert.tech/assets/controllers/syntax_highlight_controller-ae10e4cee8b4dedbf232536d05654062.js",
        "https://norbert.tech/assets/controllers/clipboard_controller.js": "https://norbert.tech/assets/controllers/clipboard_controller-6aefa8a9dec3271dae2f05b464bf9204.js",
        "highlight.js/lib/core": "https://norbert.tech/assets/vendor/highlight.js/lib/core-760145ef158caabe84ca07686407d093.js",
        "highlight.js/lib/languages/php": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/php-c0eb2105c14097e8a5a1e9a767e8ac95.js",
        "highlight.js/styles/github-dark.min.css": "data:application/javascript,document.head.appendChild%28Object.assign%28document.createElement%28%22link%22%29%2C%7Brel%3A%22stylesheet%22%2Chref%3A%22https%3A%2F%2Fnorbert.tech%2Fassets%2Fvendor%2Fhighlight.js%2Fstyles%2Fgithub-dark.min-4b46e20f66f76e35d6454ca4f09b57c3.css%22%7D%29%29",
        "@fontsource-variable/cabin/index.min.css": "data:application/javascript,document.head.appendChild%28Object.assign%28document.createElement%28%22link%22%29%2C%7Brel%3A%22stylesheet%22%2Chref%3A%22https%3A%2F%2Fnorbert.tech%2Fassets%2Fvendor%2F%40fontsource-variable%2Fcabin%2Findex.min-08e34691d22388e6974e6cb2bfbcbfd0.css%22%7D%29%29",
        "clipboard": "https://norbert.tech/assets/vendor/clipboard/clipboard.index-925566f98181665b5a61fea1bcd9033d.js",
        "highlight.js/lib/languages/shell": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/shell-664215791af27581e04813723523a355.js",
        "highlight.js/lib/languages/json": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/json-9ac51ad2a97f9ce56b2f309eb64d7b04.js",
        "highlight.js/lib/languages/twig": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/twig-0f3c6d18c0368650898b432b7bcf672a.js",
        "highlight.js/lib/languages/sql": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/sql-09f80640dd6fe9bed6ff4eb255b13f08.js",
        "highlight.js/lib/languages/javascript": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/javascript-100f963be02a503f0531e497103ff398.js",
        "highlight.js/lib/languages/xml": "https://norbert.tech/assets/vendor/highlight.js/lib/languages/xml-a2295112e12d4d01f257d59e1cfa676d.js"
    }
}
</script>
<!-- ES Module Shims: Import maps polyfill for modules browsers without import maps support -->
<script async src="https://ga.jspm.io/npm:es-module-shims@1.10.0/dist/es-module-shims.js"></script>
<link rel="modulepreload" href="https://norbert.tech/assets/app-930adf3462cf9ab60908eb1b74cf7ca7.js">
<link rel="modulepreload" href="https://norbert.tech/assets/vendor/@oddbird/popover-polyfill/popover-polyfill.index-7979d53637476aa204f709644aed2c19.js">
<link rel="modulepreload" href="https://norbert.tech/assets/bootstrap-d78d7e12c819dedf89372fb4824c072d.js">
<link rel="modulepreload" href="https://norbert.tech/assets/vendor/htmx.org/htmx.org.index-023ae86a082913526422a6063298f898.js">
<link rel="modulepreload" href="https://norbert.tech/assets/vendor/iconify-icon/iconify-icon.index-8a41e423576dc2d752509fd455f508c1.js">
<link rel="modulepreload" href="https://norbert.tech/assets/@symfony/stimulus-bundle/loader-5751ad1ee2975e725a94d8121d153d17.js">
<link rel="modulepreload" href="https://norbert.tech/assets/vendor/@hotwired/stimulus/stimulus.index-304681764684182e6662e0931532ed91.js">
<link rel="modulepreload" href="https://norbert.tech/assets/@symfony/stimulus-bundle/controllers-11c35dc7f11bbd855b8108888f18f9b7.js">
<link rel="modulepreload" href="https://norbert.tech/assets/controllers/hello_controller-55882fcad241d2bea50276ea485583bc.js">
<script type="module">import 'app';</script>
                <script defer src="https://cloud.umami.is/script.js" data-website-id="9fed007d-d990-428b-b5d9-11c6ff55a3f1"></script>
    </head>
<body class="scroll-smooth text-black relative min-h-screen pb-16">
    <div class="sticky top-0 max-h-screen overflow-y-auto bg-white py-2 px-2 border-b border-gray-500 z-[9999] print:hidden">
        <div class="grid grid-cols-2 sm:mx-auto sm:max-w-screen-2xl md:px-4">
            <div class="text-left">
                <a href="/" class="text-lg">
                    norbert.tech
                </a>
            </div>
            <div class="text-right">
                <a href="/consulting" class="text-lg inline-flex items-center space-x-1 md:mr-4 mr-2">
                    <iconify-icon icon="lineicons:consulting" class="mr-1"></iconify-icon> Consulting
                </a>
                <a href="/blog" class="text-lg inline-flex items-center space-x-1">
                    <iconify-icon icon="ooui:articles-ltr" class="mr-1"></iconify-icon> Blog
                </a>
            </div>
        </div>
    </div>
    
    <main class="mx-auto max-w-screen-2xl mb-4 md:pt-4 px-4 lg:px-0">
            <div class="px-2 py-5 sm:px-4 md:px-8 lg:px-12 mx-auto max-w-4xl">
        <ul class="mt-2 pl-[20px] flex flex-wrap gap-2 sm:gap-4">
            <li>
                <a href="/blog" class="text-sm sm:text-base text-blue-500 hover:underline px-2 py-1 rounded">Go Back</a>
            </li>
                                                                <li>
                        <a href="/blog/2025-08-12/pl/analiza-danych-w-rozproszonych-systemach-transakcyjnych"
                           class="text-sm sm:text-lg px-2 py-1 rounded hover:opacity-80"
                           title="Polish">üáµüá± Polish</a>
                    </li>
                                                                                <li>
                        <a href="/blog/2025-08-12/data-analytics-in-distributed-transactional-systems"
                           class="text-sm sm:text-lg px-2 py-1 rounded hover:opacity-80"
                           title="English">üá∫üá∏ English</a>
                    </li>
                                                                                <li>
                        <a href="/blog/2025-08-12/de/datenanalyse-in-verteilten-transaktionssystemen"
                           class="text-sm sm:text-lg px-2 py-1 rounded hover:opacity-80"
                           title="Deutsch">üá©üá™ Deutsch</a>
                    </li>
                                                                                <li>
                        <a href="/blog/2025-08-12/es/analisis-datos-sistemas-transaccionales-distribuidos"
                           class="text-sm sm:text-lg px-2 py-1 rounded hover:opacity-80"
                           title="Spanish">üá™üá∏ Spanish</a>
                    </li>
                                                                                <li>
                        <a href="/blog/2025-08-12/it/analisi-dati-sistemi-transazionali-distribuiti"
                           class="text-sm sm:text-lg px-2 py-1 rounded hover:opacity-80"
                           title="Italian">üáÆüáπ Italian</a>
                    </li>
                                    </ul>

                    <div class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                <div class="flex items-start">
                    <div class="flex-shrink-0">
                        <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h3 class="font-medium text-yellow-800">
                            Translation Notice
                        </h3>
                        <div class="mt-2 text-yellow-700">
                            <p>
                                This is an automatically translated version of that Article. Despite my best efforts, it might not be perfect.<br/>
                                Native speakers are welcome to
                                <a href="https://github.com/norberttech/norbert.tech/edit/main/templates/blog/posts/2025-08-12/analyse-donnees-systemes-transactionnels-distribues/post.html.twig"
                                   class="underline hover:text-yellow-800" target="_blank" rel="noopener">open pull requests
                                </a> to correct anything that doesn't sound right.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            </div>
    <article class="blog-post">
            <div class="img-wide">
        <img src="https://norbert.tech/assets/images/blog/analytics-in-transactional-distributed-systems/analytics_01-b27f8a842f645a9c7d9901f3fd11fde8.jpg" alt="Analyse de donn√©es dans les syst√®mes transactionnels distribu√©s" />
    </div>

    <h1 class="font-bold text-4xl mb-2" id="title">Analyse de donn√©es dans les syst√®mes transactionnels distribu√©s</h1>
    <div class="mb-2">
        <small class="text-sm">Date de publication August 12, 2025 00:00</small>
    </div>
    <div class="mb-4">
                    <small><span class="badge badge-info">analyse de donn√©es</span></small>
                    <small><span class="badge badge-info">entrep√¥t de donn√©es</span></small>
                    <small><span class="badge badge-info">ETL</span></small>
                    <small><span class="badge badge-info">traitement de donn√©es</span></small>
                    <small><span class="badge badge-info">syst√®mes transactionnels</span></small>
            </div>
    <p>
        Dans cet article, je vais aborder le probl√®me de l'analyse de donn√©es dans les syst√®mes transactionnels distribu√©s.<br/>
        Si vous cherchez des id√©es pour construire un entrep√¥t de donn√©es central qui permettra de collecter les donn√©es de l'ensemble du syst√®me,
        ind√©pendamment de sa fragmentation, tout en √©vitant de vous noyer dans les co√ªts op√©rationnels, alors cet article est fait pour vous.
    </p>

    <h2>Tout commence innocemment</h2>
    <p>
        La plupart des syst√®mes que nous cr√©ons au quotidien stockent des donn√©es dans une base de donn√©es relationnelle.
        Un choix tr√®s populaire et d'ailleurs excellent est PostgreSQL, qui est devenu ces derni√®res ann√©es
        presque un standard dans l'industrie.
    </p>
    <p>
        L'histoire de la plupart des projets se ressemble g√©n√©ralement : on commence par valider une id√©e, on gagne
        les premiers utilisateurs, le syst√®me commence √† g√©n√©rer des revenus, le business cherche √† augmenter les profits,
        de nouvelles fonctionnalit√©s voient le jour. Chaque nouvelle fonctionnalit√©, c'est quelques nouvelles tables dans la base de donn√©es.
    </p>
    <p>
        Pour acc√©l√©rer le d√©veloppement, nous utilisons un ORM, g√©n√©rons automatiquement des migrations qui cr√©ent et
        mettent √† jour le sch√©ma de la base de donn√©es.
    </p>
    <p>
        Au d√©but, tout se passe bien, les nouvelles fonctionnalit√©s apportent les profits attendus, le business commence √† se d√©velopper.
        On embauche plus de d√©veloppeurs pour cr√©er plus de fonctionnalit√©s en parall√®le.
    </p>
    <p>
        De temps en temps, quelqu'un signale que le syst√®me commence √† "ramer" √† certains endroits, reconnaissance rapide, diagnostic
        encore plus rapide, il manque un index dans une table.
    </p>
    <p>
        Dans la configuration des mappings ORM, on ajoute un index sur le champ sur lequel le syst√®me recherche tr√®s souvent des donn√©es.
        Probl√®me r√©solu.
    </p>
    <p>
        L'√©quipe grandissante de d√©veloppeurs accorde une grande importance √† la qualit√©, peut-√™tre m√™me utilise-t-elle
        des techniques avanc√©es de d√©veloppement logiciel, comme l'Event Storming ou le Domain-Driven Design.<br/>
        Le CI/CD ex√©cute d'innombrables tests, s'assurant que les changements n'introduisent pas de r√©gressions.
    </p>
    <p>
        L'idylle dure, l'√©quipe ou peut-√™tre plusieurs √©quipes commencent √† ajouter de nouveaux modules au syst√®me. Modules correctement
        isol√©s, responsables de t√¢ches sp√©cifiques, ne d√©passant jamais leurs limites et n'empi√©tant pas
        sur les comp√©tences d'autres modules.
    </p>
    <p>
        Pour la communication, on utilise √©videmment des files d'attente, on impl√©mente le
        <a href="https://event-driven.io/en/outbox_inbox_patterns_and_delivery_guarantees_explained/" target="_blank">Pattern Outbox/Inbox</a>
    </p>
    <p>
        Pour assurer une isolation appropri√©e, nous √©tablissons des r√®gles stipulant que chaque module n'a acc√®s qu'aux
        tables de la base de donn√©es qui lui appartiennent. Pour obtenir des donn√©es d'un autre module, il faut
        s'adresser √† ce module, que ce soit via une API interne ou de toute autre mani√®re.
    </p>
    <p>
        De temps en temps, le business vient nous voir avec la question <strong>pouvez-vous nous g√©n√©rer rapidement ce
            rapport ?</strong>.
        Bien s√ªr, quelques lignes en SQL, peut-√™tre quelques dizaines et le rapport est pr√™t.
    </p>
    <p>
        Le business est satisfait, le rapport au format CSV part vers Excel (l'outil BI le plus populaire), le business tire
        des conclusions,
        planifie de nouvelles fonctionnalit√©s et changements.
    </p>
    <div class="img-wide">
        <img src="https://norbert.tech/assets/images/blog/analytics-in-transactional-distributed-systems/happy_business_01-c2e68a95166ed53f6bd111a6590e9909.jpg" alt="Business Intelligence" />
    </div>

    <h2>Le temps passe, les nouvelles tables poussent comme des champignons apr√®s la pluie</h2>
    <p>
        Dans cet √©tat, nous pouvons continuer tr√®s longtemps, m√™me plusieurs bonnes ann√©es.
    </p>
    <p>
        Entre-temps, quelqu'un quelque part aura certainement l'id√©e d'ajouter au syst√®me la possibilit√© de g√©n√©rer des rapports.
        Ce n'est qu'une question de temps.
    </p>
    <p>
        Les rapports sur l'√©tat du syst√®me sont pour le business l'un des outils les plus importants donnant un aper√ßu des comportements,
        pr√©f√©rences
        ou tendances des utilisateurs. Ils permettent non seulement de comprendre ce qui se passe, mais aussi de planifier correctement ce qui
        doit encore arriver.
    </p>
    <p>
        Plus les rapports sont bons et d√©taill√©s, meilleures sont les d√©cisions qui peuvent √™tre prises sur leur base. De bonnes
        d√©cisions commerciales se traduisent par des profits plus importants, des profits plus importants se traduisent par un budget plus cons√©quent.
        Un budget plus important se traduit par de meilleurs outils, des √©quipes plus grandes, de meilleurs salaires ou primes.
    </p>
    <p>
        Il devrait donc √™tre dans l'int√©r√™t de chaque d√©veloppeur de fournir au business les meilleures donn√©es possibles et les
        plus pr√©cises, apr√®s tout, de meilleurs r√©sultats se traduisent directement par de meilleurs profits.
    </p>
    <h2>Premiers sympt√¥mes</h2>
    <p>
        Le syst√®me fonctionne, g√©n√®re des profits. Il se compose d'environ 5, peut-√™tre m√™me 10 modules, chaque module comprend 20-50
        tables dans
        la base de donn√©es. Chaque module fournit ses propres rapports.
    </p>
    <ul>
        <li>Ventes</li>
        <li>Marketing</li>
        <li>Logistique</li>
        <li>√âtats des stocks</li>
        <li>Utilisateurs</li>
    </ul>
    <p>
        Chaque module ne fournit qu'une partie des donn√©es, une fraction d'une image plus grande, mais aucun ne donne une vue d'ensemble.
    </p>
    <p>
        Les √©quipes ont certes impl√©ment√© des cl√©s r√©f√©rentielles vers des donn√©es provenant d'autres modules, elles ont m√™me r√©ussi
        dans l'interface utilisateur √† cr√©er un endroit unique d'o√π l'on peut g√©n√©rer des rapports.
    </p>
    <p>
        Mais c'est encore insuffisant...
    </p>
    <p>
        Tr√®s vite, il s'av√®re que les rapports g√©n√©r√©s dans diff√©rents modules, √©crits par diff√©rents d√©veloppeurs, peut-√™tre
        m√™me dans diff√©rentes technologies ont des formats de donn√©es diff√©rents, des standards de nommage diff√©rents.
    </p>
    <p>
        Les plages de dates sont interpr√©t√©es diff√©remment, un module inclut les dates de fin et de d√©but, un autre les exclut,
        et encore un autre fait un intervalle ouvert √† droite pour faciliter la pagination, parce qu'ils ont justement
        aussi une API et cette API utilise le m√™me morceau de code.
    </p>
    <p>
        Comme chaque module est ind√©pendant, poss√®de ses fronti√®res, sa nomenclature, √† un moment donn√© nous r√©alisons
        que ce que nous appelons d'une certaine mani√®re dans un module, un autre module l'expose sous un nom compl√®tement diff√©rent.
        Parce que dans le contexte de ce module, cela a du sens.
    </p>
    <p>
        Avec le temps, nous r√©aliserons probablement aussi que chaque √©quipe a d√©fini diff√©remment sa politique de r√©tention et
        de stockage des donn√©es.
        Malgr√© la possession de donn√©es des 5 derni√®res ann√©es dans le module cl√©, nous ne pouvons rien en faire, car les modules qui
        fournissaient
        les donn√©es n√©cessaires pour enrichir le rapport de base ne poss√®dent des donn√©es que des 2 derni√®res ann√©es.
    </p>
    <p>
        Ce ne sont cependant pas des probl√®mes qu'un peu de magie dans Excel ne pourrait r√©soudre (peut-√™tre √† part les lacunes
        dans les donn√©es).
        Nous changerons les noms de ces colonnes, supprimerons celles-ci, ajouterons un filtre rapide et c'est suffisant.
    </p>
    <p>
        Nous cr√©erons un grand fichier dans lequel nous aurons une feuille nomm√©e "Dashboard", et toutes les
        autres seront en lecture seule, alimentant le dashboard.
    </p>
    <p>
        Peut-√™tre que cette approche fonctionnera m√™me un moment. Peut-√™tre m√™me plus qu'un moment, mais ne nous faisons pas d'illusions.
        Tout cela finira par s'effondrer, et conform√©ment aux lois de
        <a href="https://en.wikipedia.org/wiki/Murphy%27s_law" target="_blank">Murphy</a>
        cela s'effondrera au pire moment possible.
    </p>
    <h2>Qu'est-ce qui ne va pas avec Excel ?</h2>
    <p>
        Rien ! Excel est un outil formidable. Le probl√®me ne r√©side pas dans Excel, mais dans son utilisation.
    </p>
    <p>
        Toute cette magie consistant √† nettoyer et pr√©parer les donn√©es ne devrait pas avoir lieu dans Excel, pas
        √† grande √©chelle. Si nous parlons d'un rapport rapide ponctuel, pas de probl√®me. Nous faisons ce que nous devons,
        tapons les formules, analysons les donn√©es et oublions.
    </p>
    <p>
        Cependant, si cela doit faire partie de notre routine quotidienne, si nous devons cycliquement passer par le m√™me
        processus, en suivant les changements constants et l'√©volution du syst√®me, t√¥t ou tard il s'av√©rera que ces feuilles de calcul sont
        obsol√®tes.
    </p>
    <p>
        Les colonnes ont cess√© d'exister ou ont chang√© de nom, de nouvelles colonnes sont apparues, le format des donn√©es a chang√© ou
        pire encore, l'une des √©quipes s'occupant d'un des modules a supprim√© certaines donn√©es sans savoir qu'elles √©taient
        utilis√©es
        par un utilisateur m√©tier quelque part dans l'un de ses rapports qu'il ouvre une fois par trimestre.
    </p>
    <p>
        Sur le long terme, les feuilles de calcul plus complexes, qui puisent des donn√©es dans des rapports g√©n√©r√©s automatiquement par
        le syst√®me, qui sont ensuite assembl√©es sur la base de r√®gles non explicites, sont impossibles √† maintenir.
    </p>
    <h2>Et si on connectait un outil BI ?</h2>
    <p>
        Ont pens√© de nombreux d√©veloppeurs qui ont rencontr√© √† plusieurs reprises le probl√®me de g√©n√©ration de rapports.
    </p>
    <p>
        Prenons par exemple <a href="https://www.metabase.com/" target="_blank">Metabase</a>. Un outil gratuit que
        nous pouvons mettre en place en quelques minutes avec Docker.
    </p>
    <p>
        Lui donner acc√®s √† notre base de donn√©es et √† quelques ou toutes les tables, et gr√¢ce √† une interface utilisateur
        tr√®s conviviale, le business pourra g√©n√©rer tr√®s facilement et agr√©ablement les rapports les plus complexes.
    </p>
    <p>
        Des rapports qui pourront contenir des donn√©es de plusieurs modules simultan√©ment !
    </p>
    <p>
        Nous pouvons m√™me embaucher un analyste de donn√©es avec des bases en SQL, qui tout ce qui ne pourra
        pas √™tre cliqu√©, l'obtiendra gr√¢ce √† une requ√™te bien pr√©par√©e.
    </p>
    <h2>Sauf que cela ne r√©sout pas le probl√®me</h2>
    <p>
        Cela ne fait que le repousser dans le temps.
    </p>
    <p>
        Si nous regardons attentivement ce qui a chang√©, une seule chose a chang√©. L'outil...
        Nous avons transf√©r√© le probl√®me de nettoyage et de liaison des donn√©es d'Excel √† Metabase.
    </p>
    <p>
        Excel est certes revenu √† son r√¥le initial, nous pouvons maintenant importer les rapports t√©l√©charg√©s depuis Metabase dans Excel.
    </p>
    <p>
        Cependant, notre logique implicite de liaison/nettoyage des donn√©es s'est d√©plac√©e de la feuille de calcul vers les requ√™tes
        SQL.
    </p>
    <p>
        De plus, tous les probl√®mes sont rest√©s les m√™mes :
    </p>
    <ul>
        <li>incoh√©rence des donn√©es</li>
        <li>incoh√©rence de la nomenclature</li>
        <li>absence de politique uniforme de r√©trocompatibilit√©</li>
        <li>absence de politique uniforme de r√©tention des donn√©es</li>
    </ul>
    <h2>Et si on √©tablissait des processus et des r√®gles ?</h2>
    <p>
        La plupart des probl√®mes ci-dessus peuvent √™tre r√©solus en impl√©mentant des processus et des r√®gles appropri√©s.
    </p>
    <p>
        Nous pouvons √©tablir des standards de nommage stipulant que chaque table dans la base doit contenir dans son nom le pr√©fixe du module, et
        les colonnes sont nomm√©es en minuscules et s√©par√©es par des underscores.
    </p>
    <p>
        Nous pouvons √©tablir que chaque module stocke les donn√©es des 5 derni√®res ann√©es (hot storage), tout ce qui est plus ancien est
        archiv√©. (cold storage)
    </p>
    <p>
        Nous pouvons √©tablir que les plages de dates sont toujours trait√©es comme des intervalles ouverts √† droite.
    </p>
    <p>
        Nous pouvons √©tablir que nous ne supprimons aucune colonne de la base de donn√©es, ou qu'avant de supprimer quoi que ce soit, nous entrons
        d'abord dans une p√©riode de transition, pendant laquelle nous montrons √† chaque utilisateur du syst√®me
        quelles colonnes vont changer et comment.
    </p>
    <p>
        M√™me si nous supposons pour les besoins de la discussion qu'il sera possible d'impl√©menter ces processus globalement entre plusieurs
        √©quipes,
        et que ces √©quipes les respecteront strictement et tr√®s pr√©cis√©ment, <strong>ce ne sera pas suffisant...</strong>
    </p>
    <h2>La mise √† l'√©chelle de la base de donn√©es n'est pas bon march√©</h2>
    <p>
        Surtout si nous nous appuyons sur des solutions cloud.
    </p>
    <p>
        Imaginons une situation o√π, aux heures de pointe du syst√®me (quand les utilisateurs g√©n√®rent le plus de
        transactions),
        un analyste m√©tier, qui travaille selon son propre planning, doit g√©n√©rer un rapport bas√© sur un SQL typique
        de plusieurs milliers de lignes ?
    </p>
    <p>
        L'analyste lance la requ√™te, la base de donn√©es commence √† mouliner. La requ√™te dure 5, 10, 15 minutes.
        La base de donn√©es commence √† transpirer.
    </p>
    <p>
        Les utilisateurs bombardent le syst√®me de nouvelles commandes (ou toute autre op√©ration qui g√©n√®re beaucoup
        d'√©critures)
        pendant que l'analyste attend les r√©sultats.
    </p>
    <p>
        Au m√™me moment, quelqu'un du business a besoin de v√©rifier rapidement quelques rapports, chacun d'eux contient
        le "nombre total de lignes dans la table".
        Il y a plusieurs personnes comme √ßa.
    </p>
    <p>
        Toutes ces op√©rations se superposent, notre base de donn√©es d√©j√† tr√®s charg√©e ne suit plus.
    </p>
    <p>
        Certaines transactions utilisateur n'aboutissent pas. <br/>
        Le syst√®me respire √† peine. Le temps d'attente pour les op√©rations les plus basiques se mesure en secondes.
    </p>
    <p>
        Et maintenant la cerise sur le g√¢teau, quand toutes ces sc√®nes dantesques ont lieu, quand Pager Duty est chauff√© au
        rouge par toutes sortes d'incidents, quand les √©quipes paniquent en essayant de ramener le syst√®me √† la vie,
        les devops cherchent comment mettre rapidement √† l'√©chelle la base de donn√©es...
    </p>
    <div class="img-wide">
        <img class="mt-[-150px]" src="https://norbert.tech/assets/images/blog/analytics-in-transactional-distributed-systems/construction_01-59e51f16aa79ecadc241f490217f29a0.jpg" alt="Travaux de r√©novation" />
    </div>
    <p>
        Le PDG commence une pr√©sentation pour un partenaire commercial potentiel, avec qui la collaboration
        doit s'av√©rer cruciale dans la strat√©gie de d√©veloppement de l'entreprise...
    </p>
    <h2>Et si on mettait simplement en place une r√©plique ?</h2>
    <p>
        Apr√®s tout, les rapports ne surchargeront pas notre base de donn√©es transactionnelle.
    </p>
    <p>
        Nous doublerons certes les co√ªts de maintenance de la base de donn√©es, mais nous r√©duirons le risque de surcharge du syst√®me et nous pourrons
        connecter notre outil de business intelligence pr√©f√©r√© directement √† la r√©plique, ce qui nous donnera des donn√©es en temps r√©el.
    </p>
    <p>
        √áa sonne g√©nial, mais en pratique ce n'est pas si simple.
    </p>
    <p>
        En mettant de c√¥t√© les probl√®mes potentiels d√©coulant de la nature m√™me de la r√©plication, le probl√®me principal et fondamental
        que je rencontre le plus souvent, c'est la <strong>perception</strong>.
    </p>
    <p>
        Un d√©veloppeur qui a g√©n√©r√© ces tables via des mappings ORM regardera les tables de la base de donn√©es tr√®s diff√©remment
        d'un analyste de donn√©es.
    </p>
    <p>
        Le d√©veloppeur saura quelles tables doivent √™tre jointes ensemble pour obtenir une image compl√®te.
        Il comprendra les limitations et conditions cach√©es quelque part dans le code de l'application.
        Surtout, le d√©veloppeur conna√Æt ou devrait au moins avoir une id√©e du cycle de vie du syst√®me (de ses
        donn√©es).
    </p>
    <p>
        Toute cette connaissance n'est g√©n√©ralement pas disponible pour les analystes.
    </p>
    <p>
        C'est comme dire √† quelqu'un de regarder quelque chose par le trou de la serrure. On peut certainement voir quelque chose.
        On peut tirer certaines conclusions, mais il sera tr√®s difficile de reconstruire l'ensemble.
    </p>
    <p>
        Il suffit que nous ayons dans la base de donn√©es une colonne de type JSONB dans laquelle nous stockons certaines structures de donn√©es.
        Supposons que le syst√®me autorise 3 combinaisons correctes de la m√™me structure, mais l'une est super rare, si rare
        qu'elle n'est pas encore apparue dans le syst√®me. En regardant les donn√©es, m√™me dans leur ensemble, l'analyste ne peut simplement pas savoir
        qu'il existe 3 combinaisons d'une structure. Lors de la normalisation, il prendra en compte 2 cas, tandis que le troisi√®me
        deviendra une bombe √† retardement qui explosera comme toujours au moment le moins attendu.
    </p>
    <p>
        En d'autres termes, si nous avons dans le syst√®me plusieurs modules ind√©pendants. Chacun avec sa base de donn√©es, ou au moins
        ses tables dans la base. Ce qui nous donne au total 200-300 tables, s'attendre √† ce que l'analyste g√®re cela sans probl√®me,
        ne commette pas d'erreurs et que les rapports ne s'√©cartent pas des attentes, est pour le moins na√Øf.
    </p>
    <p>
        Malgr√© tout, exposer une copie/r√©plique de la base de donn√©es pour les analystes et lui donner un nom √† 4 lettres d√©riv√©
        du mot "analytics" est encore largement pratiqu√©.
    </p>
    <p>
        Les outils BI rivalisent pour cr√©er la meilleure interface utilisateur, gr√¢ce √† laquelle les rapports peuvent √™tre
        cliqu√©s.
        Ils promettent que nous pourrons analyser les donn√©es sans SQL.
    </p>
    <p>
        Oui, cela peut fonctionner, dans de nombreux endroits c'est exactement comme √ßa que √ßa fonctionne. Mais ce dont nous ne parlons pas ouvertement, c'est :
    </p>
    <ul>
        <li>Probl√®mes de r√©trocompatibilit√© et de changements de structure de donn√©es</li>
        <li>Probl√®mes de maintenance appropri√©e / versioning / test de requ√™tes SQL gigantesques/scripts
            normalisant les donn√©es √† la vol√©e
        </li>
        <li>Les r√©pliques/copies g√©n√®rent des co√ªts suppl√©mentaires</li>
        <li>La r√©duction des ressources des r√©pliques est soit impossible, soit emp√™che la g√©n√©ration de rapports dans des
            temps acceptables
        </li>
    </ul>
    <p>
        Ce qui se r√©percute sur la qualit√© des donn√©es et l'efficacit√© de la prise de d√©cisions commerciales.
    </p>
    <h2>Que nous reste-t-il ?</h2>
    <p>
        Peut-√™tre commen√ßons par √©tablir quels probl√®mes nous voulons r√©soudre en priorit√© :
    </p>
    <div class="img-wide">
        <img src="https://norbert.tech/assets/images/blog/analytics-in-transactional-distributed-systems/strategy_01-f82682bfa13643ba5b8957e806e0d823.jpg" alt="Strat√©gie et analyse" />
    </div>
    <ol>
        <li>L'analyse des donn√©es / g√©n√©ration de rapports ne doit avoir aucun impact sur le fonctionnement du syst√®me.</li>
        <li>Les donn√©es dans les rapports doivent toujours √™tre fra√Æches (un d√©lai dans les donn√©es est acceptable, d√©fini individuellement)</li>
        <li>Les rapports doivent refl√©ter l'√©tat r√©el, non d√©form√© du syst√®me</li>
        <li>La structure des donn√©es doit √™tre r√©sistante √† la r√©gression</li>
        <li>Politique coh√©rente de r√©tention et d'archivage des donn√©es</li>
    </ol>
    <h2>1) S√©paration des ressources</h2>
    <p>
        Ce n'est rien de r√©volutionnaire, si nous ne voulons pas que notre syst√®me soit expos√© aux surcharges
        r√©sultant de l'abus de la base de donn√©es par la g√©n√©ration de rapports, nous devons mettre en place une base de donn√©es s√©par√©e.
    </p>
    <p><strong>Quelle base choisir pour l'analytique ?</strong></p>
    <p>
        C'est en fait un sujet pour un article s√©par√© ou m√™me une s√©rie d'articles.
        Il y a beaucoup de solutions, certaines meilleures, d'autres moins bonnes. Il n'existe pas de
        solution magique unique pour tous les probl√®mes.
    </p>
    <p>
        Mon conseil, surtout pour les petites √©quipes, inexp√©riment√©es dans la gestion des donn√©es, est de ne pas
        se jeter sur des technologies avec lesquelles nous n'avons pas d'exp√©rience.
    </p>
    <p>
        Le format appropri√© des donn√©es est crucial. Apr√®s avoir transform√© de nombreuses tables √©troites en une seule large, il s'av√©rera probablement
        que g√©n√©rer le m√™me rapport sans utiliser 20x <code>JOIN</code> ne prend plus 10 minutes
        mais moins d'une demi-seconde.
    </p>
    <p>
        Et si le probl√®me ce sont les agr√©gations, et non les jointures ?
    </p>
    <p>
        Alors, au lieu d'agr√©ger √† la vol√©e, il vaut mieux pr√©parer une table contenant ces donn√©es sous forme agr√©g√©e, et non
        brute.
    </p>
    <h2>2) Donn√©es fra√Æches</h2>
    <p>
        Bon d'accord, mais si nous cr√©ons une nouvelle base de donn√©es ind√©pendante, comment nous assurerons-nous que les donn√©es dans cette
        base sont fra√Æches et √† jour ?
    </p>
    <p>
        Ici, beaucoup d√©pend du d√©lai acceptable dans la synchronisation des donn√©es.
        Le plus souvent, il suffit que la base analytique soit environ 24 heures derri√®re la base transactionnelle. C'est-√†-dire qu'elle contient
        des donn√©es jusqu'√† "hier", en incluant tout "hier".
    </p>
    <p>
        Pourquoi ? Parce que peu de d√©cisions commerciales sont prises dans l'instant.
        Si certaines d√©cisions doivent √™tre prises dans un d√©lai aussi court, alors on construit les automatisations appropri√©es.
    </p>
    <p>
        Si un d√©lai de 24 heures est acceptable (parfois ce n'est pas le cas et il y a aussi des solutions pour cela),
        il suffit que nous effectuions la synchronisation plusieurs fois par jour.
        Bien s√ªr, ici non plus il n'y a pas de r√®gle d'or. De m√™me qu'il n'y a pas de r√®gle disant quelle taille de plage synchroniser √† la fois.
    </p>
    <p>
        Il y a cependant une bonne pratique qui facilite la synchronisation. Elle consiste √† s'assurer que les tables principales dans le
        syst√®me transactionnel contiennent la date de cr√©ation/modification de l'enregistrement.
    </p>
    <p>
        En poss√©dant ces deux informations, nous sommes en mesure de r√©duire la fen√™tre de synchronisation √† une p√©riode de temps sp√©cifique.
    </p>
    <p>
        √Ä quoi cela ressemble-t-il en pratique ? Nous pouvons par exemple lancer le processus de synchronisation toutes les 6 heures, en collectant uniquement les enregistrements modifi√©s au
        cours des derni√®res 24 heures.<br/>
        <code>Bien s√ªr, ce sont des chiffres d'exemple, ces valeurs doivent √™tre √©tablies sur la base de la taille et du comportement des donn√©es.</code>
    </p>
    <p>
        Pourquoi 24 heures ? C'est une s√©curit√© suppl√©mentaire. Nous pourrions r√©cup√©rer les donn√©es seulement des 7 derni√®res heures, mais si pour une raison quelconque
        la synchronisation ne s'ex√©cute pas et que nous ne le d√©tectons pas, nous pouvons perdre des donn√©es.
    </p>
    <h2>3) Reflet de l'√©tat du syst√®me</h2>
    <p>
        Mon opinion sur ce sujet peut sembler controvers√©e, mais je pense que la meilleure connaissance des donn√©es et du comportement
        du syst√®me ou du module appartient √† l'√©quipe qui construit ce syst√®me/module.
    </p>
    <p>
        C'est pr√©cis√©ment cette √©quipe qui devrait √™tre responsable de s'assurer que les donn√©es g√©n√©r√©es par le syst√®me ou sa partie
        dont l'√©quipe donn√©e est responsable, arrivent dans le r√©f√©rentiel central de donn√©es.
    </p>
    <p>
        En d'autres termes, c'est l'√©quipe impl√©mentant une fonctionnalit√© donn√©e qui devrait, sur la base des exigences collect√©es pr√©c√©demment,
        transformer ces donn√©es au format appropri√© et les pousser plus loin.
    </p>
    <p>
        C'est probablement le moyen le plus simple de s'assurer que les donn√©es sont compl√®tes et que les d√©veloppeurs de l'√©quipe donn√©e sont
        conscients que ces donn√©es sont utilis√©es quelque part. Le format des donn√©es analytiques devient pour eux
        une sorte de contrat ‚Äì un contrat qu'ils doivent respecter.
    </p>
    <p>
        Ce n'est pas tr√®s diff√©rent d'un contrat sur le sch√©ma API.
    </p>
    <h2>4) R√©sistance √† la r√©gression</h2>
    <p>
        Ce point est probablement le plus compliqu√©. L'impl√©mentation correcte de l'√©volution du sch√©ma de donn√©es est
        souvent non pas tant difficile que fastidieuse.
    </p>
    <p>
        En r√©sum√©, les r√®gles ressemblent √† ceci :
    </p>
    <ul>
        <li>On ne supprime jamais de colonnes</li>
        <li>Toutes les colonnes que nous ajoutons doivent √™tre <code>nullable</code> ou avoir une valeur par d√©faut</li>
        <li>Les types de colonnes ne peuvent √™tre qu'√©tendus par exemple, <code>int</code> peut √™tre chang√© en <code>bigint</code> mais pas l'inverse</li>
        <li>On ne change pas les noms des colonnes</li>
    </ul>
    <p>
        Alors ne pouvons-nous rien supprimer ?
    </p>
    <p>
        Si, mais pas n'importe comment. En g√©n√©ral, comment et √† quelle fr√©quence nous briserons la r√©trocompatibilit√© ne d√©pend que de nous.
    </p>
    <p>
        Si nous utilisons notre source de donn√©es analytiques uniquement en interne et, disons, l'analyste s'occupant de la construction
        des rapports est au courant des changements dans le syst√®me, avec une coordination appropri√©e, nous pourrions ajouter
        de nouvelles tables, puis supprimer les anciennes, en lui donnant un moment pour mettre √† jour les rapports.
    </p>
    <p>
        Cependant, si notre source de donn√©es analytiques est utilis√©e pour la <code>Data Science</code>, mais que nous travaillons dans un environnement
        multi-tenant et que les donn√©es analytiques/rapports sont mis √† disposition des clients, alors nous devons aborder la question compl√®tement diff√©remment.
    </p>
    <h2>Politique de stockage et d'archivage des donn√©es</h2>
    <p>
        Comme je l'ai mentionn√© plus haut, il est tr√®s important que les donn√©es dans la base analytique, en particulier celles fournies par diff√©rents
        modules, soient soumises aux m√™mes r√®gles concernant le temps de stockage.
    </p>
    <p>
        Si nous ne conservons les √©tats de stock dans le syst√®me que de la derni√®re ann√©e, et les commandes des 5 derni√®res ann√©es,
        les analystes ne pourront pas construire un rapport qui contiendra des donn√©es de ces deux sources.
    </p>
    <p>
        C'est plus un probl√®me de nature formelle que technique. Il semblerait qu'il suffit de simplement se mettre d'accord,
        cependant en pratique ce n'est pas si simple.
    </p>
    <p>
        Pour √©tablir une politique commune de stockage et d'archivage des donn√©es, il faut prendre en compte non seulement les aspects
        techniques, mais aussi juridiques, commerciaux ou justement analytiques, ce qui peut n√©cessiter des compromis.
    </p>
    <h2>Exemples</h2>
    <p>
        Regardons maintenant un exemple simple de processus ETL, dont la t√¢che est de transf√©rer des donn√©es de la base transactionnelle
        vers la base analytique.
    </p>
    <blockquote>
        Dans cet exemple, j'utiliserai <a href="https://flow-php.com" target="_blank">Flow PHP</a>, ce n'est
        cependant pas quelque chose de particuli√®rement unique √† PHP. Dans n'importe quel langage, nous pouvons construire quelque chose de tr√®s similaire en utilisant
        n'importe quelle biblioth√®que facilitant la cr√©ation d'applications CLI et un outil de traitement de donn√©es.
    </blockquote>
    <p>
        L'exemple ci-dessous (sous une forme l√©g√®rement modifi√©e) provient d'une session de live stream que j'ai eu le plaisir d'enregistrer avec Roland qui anime la cha√Æne <a href="https://nevercodealone.de/de" target="_blank">Never Code Alone</a>.
        Vous trouverez le mat√©riel vid√©o sur YouTube sous le terme "Flow PHP"
    </p>
    <p>
        Supposons que le format des commandes ressemble √† peu pr√®s √† ceci :
    </p>
    <pre><code class="code-shell" data-controller="syntax-highlight">schema
|-- order_id: ?uuid
|-- seller_id: uuid
|-- created_at: datetime
|-- updated_at: datetime
|-- cancelled_at: ?datetime
|-- discount: ?float
|-- email: string
|-- customer: string
|-- address: map&lt;string, string&gt;
|-- notes: list&lt;string&gt;
|-- items: list&lt;structure{sku: string, quantity: integer, price: float}&gt;</code></pre>

    <p>
        Notre objectif est de transf√©rer ces commandes vers la base de donn√©es analytique, pr√©parons donc le sch√©ma des donn√©es
        d'entr√©e et de destination.
    </p>

    <pre><code class="code-php" data-controller="syntax-highlight">&lt;?php

declare(strict_types=1);

namespace App\DataFrames;

// use statements

final class Orders
{
    public static function sourceSchema() : Schema
    {
        return schema(
            uuid_schema(&quot;order_id&quot;),
            uuid_schema(&quot;seller_id&quot;),
            datetime_schema(&quot;created_at&quot;),
            datetime_schema(&quot;updated_at&quot;, nullable: true),
            datetime_schema(&quot;cancelled_at&quot;, nullable: true),
            float_schema(&quot;discount&quot;, nullable: true),
            string_schema(&quot;email&quot;),
            string_schema(&quot;customer&quot;),
            map_schema(&quot;address&quot;, type: type_map(key_type: type_string(), value_type: type_string())),
            list_schema(&quot;notes&quot;, type: type_list(element: type_string())),
            list_schema(&quot;items&quot;, type: type_list(element: type_structure(elements: [&quot;item_id&quot; =&gt; type_string(), &quot;sku&quot; =&gt; type_string(), &quot;quantity&quot; =&gt; type_integer(), &quot;price&quot; =&gt; type_float()]))),
        );
    }

    public static function destinationSchema() : Schema
    {
        return self::sourceSchema()
            -&gt;replace(&#039;updated_at&#039;, datetime_schema(&quot;updated_at&quot;))
            -&gt;remove(&#039;address&#039;)
            -&gt;add(
                string_schema(&#039;street&#039;, metadata: DbalMetadata::length(2048)),
                string_schema(&#039;city&#039;, metadata: DbalMetadata::length(512)),
                string_schema(&#039;zip&#039;, metadata: DbalMetadata::length(32)),
                string_schema(&#039;country&#039;, metadata: DbalMetadata::length(128)),
            )
            -&gt;remove(&#039;items&#039;)
            -&gt;add(
                uuid_schema(&#039;item_id&#039;, metadata: DbalMetadata::primaryKey()),
                string_schema(&#039;sku&#039;, metadata: DbalMetadata::length(64)),
                integer_schema(&#039;quantity&#039;),
                integer_schema(&#039;price&#039;),
                string_schema(&#039;currency&#039;, metadata: DbalMetadata::length(3)),
            )
            ;
    }
}</code></pre>

    <p>
        Notez que la structure de la table de destination n'est plus orient√©e sur les commandes, mais sur les articles command√©s.
        Notre objectif est de d√©compresser les articles des commandes de sorte que chacun soit une ligne s√©par√©e.
    </p>
    <p>
        Gr√¢ce √† cela, l'analyste qui devra g√©n√©rer un rapport n'aura plus besoin de bricoler et d√©compresser
        le json √† la vol√©e.
    </p>
    <p>
        La colonne Adresse a √©galement √©t√© divis√©e en plusieurs colonnes, gr√¢ce √† quoi le rapport pourra √™tre plus facilement
        filtr√©.
    </p>
    <p>
        Une autre transformation importante est le changement de <code>price</code> de <code>float</code> √† <code>int</code>
        en multipliant la valeur √† virgule flottante par 100.
    </p>
    <p>
        Le dernier changement sera l'ajout d'informations sur la devise dans laquelle les prix sont donn√©s. Mais d'o√π vient cette information ?
        C'est un d√©tail tr√®s important r√©sultant d'une impl√©mentation pas tr√®s bonne.
        Dans ce cas particulier, toutes les commandes sont en dollars. Le syst√®me le sait, les d√©veloppeurs le savent,
        mais une personne regardant les tables dans la base sans contexte peut ne pas avoir cette connaissance.
    </p>
    <p>
        Notre structure de destination devrait ressembler √† peu pr√®s √† ceci :
    </p>

    <pre><code class="code-shell" data-controller="syntax-highlight">schema
|-- order_id: uuid
|-- seller_id: uuid
|-- created_at: datetime
|-- updated_at: datetime
|-- cancelled_at: ?datetime
|-- discount: ?float
|-- email: string
|-- customer: string
|-- notes: list&lt;string&gt;
|-- street: string
|-- city: string
|-- zip: string
|-- country: string
|-- item_id: uuid
|-- sku: string
|-- quantity: integer
|-- price: integer
|-- currency: string</code></pre>

    <p>
        L'√©tape suivante sera de cr√©er la table appropri√©e dans la base analytique. Nous pouvons y parvenir relativement
        facilement gr√¢ce √† l'adaptateur pour Doctrine DBAL.
    </p>

    <pre><code class="code-php" data-controller="syntax-highlight">&lt;?php

declare(strict_types=1);

namespace App\Dbal;

// use statements

final class SchemaProvider implements MigrationsSchemaProvider
{
    public const ANALYTICAL_ORDER_LINE_ITEMS = &#039;order_line_items&#039;;

    public function createSchema(): Schema
    {
        return new Schema(
            tables: [
                to_dbal_schema_table(Orders::destinationSchema(), self::ANALYTICAL_ORDER_LINE_ITEMS),
            ]
        );
    }
}</code></pre>

    <p>
        Dans la base analytique, nous stockerons donc une version "simplifi√©e" ou "normalis√©e" de la table des commandes.
        La normalisation consiste √† d√©compresser les articles de la commande et √† en faire des lignes s√©par√©es ainsi qu'√†
        diviser la colonne "Adresse" en plusieurs colonnes.
    </p>

    <p>
        Examinons donc la commande CLI qui sera responsable du transfert des donn√©es de la base transactionnelle
        vers la base analytique.
    </p>

    <pre><code class="code-php" data-controller="syntax-highlight">&lt;?php

namespace App\Command;

// use statements

#[AsCommand(
    name: &#039;app:orders:import&#039;,
    description: &#039;Import orders from the transactional database to the analytical database.&#039;,
)]
class OrdersImportCommand extends Command
{
    public function __construct(
        private readonly Connection $transactional,
        private readonly Connection $analytical,
    )
    {
        parent::__construct();
    }

    protected function configure()
    {
        $this-&gt;addOption(&#039;start-date&#039;, null, InputOption::VALUE_REQUIRED, &#039;Start date for the data pull.&#039;, &#039;-24 hours&#039;)
            -&gt;addOption(&#039;end-date&#039;, null, InputOption::VALUE_REQUIRED, &#039;End date for the data pull.&#039;, &#039;now&#039;)
        ;
    }


    protected function execute(InputInterface $input, OutputInterface $output): int
    {
        $io = new SymfonyStyle($input, $output);

        $io-&gt;title(&#039;Importing orders&#039;);

        $startDate = type_datetime()-&gt;cast($input-&gt;getOption(&#039;start-date&#039;));
        $endDate = type_datetime()-&gt;cast($input-&gt;getOption(&#039;end-date&#039;));

        $io-&gt;progressStart();

        $report = data_frame()
            -&gt;read(
                from_dbal_key_set_qb(
                    $this-&gt;transactional,
                    $this-&gt;transactional-&gt;createQueryBuilder()
                        -&gt;select(&#039;*&#039;)
                        -&gt;from(SchemaProvider::ORDERS)
                        -&gt;where(&#039;updated_at BETWEEN :start_date AND :end_date&#039;)
                        -&gt;setParameter(&#039;start_date&#039;, $startDate-&gt;format(&#039;Y-m-d H:i:s&#039;))
                        -&gt;setParameter(&#039;end_date&#039;, $endDate-&gt;format(&#039;Y-m-d H:i:s&#039;)),
                    pagination_key_set(
                        pagination_key_desc(&#039;updated_at&#039;),
                        pagination_key_desc(&#039;order_id&#039;)
                    )
                )-&gt;withSchema(Orders::sourceSchema())
            )
            -&gt;withEntry(&#039;_address&#039;, ref(&#039;address&#039;)-&gt;unpack())
            -&gt;renameEach(rename_replace(&#039;_address.&#039;, &#039;&#039;))
            -&gt;withEntry(&#039;_item&#039;, ref(&#039;items&#039;)-&gt;expand())
            -&gt;withEntry(&#039;_item&#039;, ref(&#039;_item&#039;)-&gt;unpack())
            -&gt;renameEach(rename_replace(&#039;_item.&#039;, &#039;&#039;))
            -&gt;drop(&#039;_item&#039;, &#039;items&#039;, &#039;address&#039;)
            -&gt;withEntry(&#039;currency&#039;, lit(&#039;USD&#039;))
            -&gt;withEntry(&#039;price&#039;, ref(&#039;price&#039;)-&gt;multiply(100))
            -&gt;constrain(constraint_unique(&#039;item_id&#039;))
            -&gt;match(Orders::destinationSchema())
            -&gt;write(
                to_dbal_table_insert(
                    $this-&gt;analytical,
                    SchemaProvider::ORDER_LINE_ITEMS,
                    SqliteInsertOptions::fromArray([
                        &#039;conflict_columns&#039; =&gt; [&#039;item_id&#039;],
                    ])
                )
            )
            -&gt;run(function (Rows $rows) use ($io) {
                $io-&gt;progressAdvance($rows-&gt;count());
            }, analyze: analyze())
        ;

        $io-&gt;progressFinish();

        $io-&gt;newLine();

        $io-&gt;definitionList(
            &#039;Orders Import Summary&#039;,
            new TableSeparator(),
            [&#039;Execution time &#039; =&gt; \number_format($report-&gt;statistics()-&gt;executionTime-&gt;highResolutionTime-&gt;seconds) . &#039; seconds&#039;],
            [&#039;Memory usage &#039; =&gt; \number_format($report-&gt;statistics()-&gt;memory-&gt;max()-&gt;inMb()) . &#039; MB&#039;],
            [&#039;Rows inserted &#039; =&gt; \number_format($report-&gt;statistics()-&gt;totalRows())],
        );

        return Command::SUCCESS;
    }
}
</code></pre>

    <blockquote>
        Bien s√ªr, ce n'est pas la forme la plus belle ni m√™me la plus correcte. Normalement, la commande CLI ne contiendrait pas
        la d√©finition du <code>pipeline ETL</code>, mais pour les besoins de l'exemple, c'est un bon d√©but.
    </blockquote>

    <p>
        Un entrep√¥t de donn√©es central d√©di√© est sans aucun doute une option tentante, surtout dans les endroits
        o√π le manque de visibilit√© emp√™che une prise de d√©cision efficace.
    </p>
    <p>
        Heureusement, c'est le type de fonctionnalit√© qui peut √™tre ajout√© √† pratiquement n'importe quelle √©tape de la vie du projet.
    </p>
    <p>
        Cela peut n√©cessiter l'introduction de processus suppl√©mentaires et d'une certaine discipline de la part des √©quipes, mais les avantages d'une telle solution sont √©normes.
    </p>
    <ul>
        <li>Pas de crainte que l'analytique affecte le fonctionnement du syst√®me</li>
        <li>Nous avons acc√®s √† tous les recoins de notre syst√®me, chaque microservice ou module</li>
        <li>Une telle base de donn√©es centrale est le meilleur cadeau pour les analystes</li>
        <li>La Data Science ne consiste plus √† br√ªler du temps √† nettoyer les donn√©es</li>
        <li>Nous pouvons facilement et en toute s√©curit√© connecter pratiquement n'importe quel outil de type Business Intelligence</li>
        <li>Nous cr√©ons une culture de travail avec les donn√©es au sein de notre organisation</li>
    </ul>
    <p>
        Bien s√ªr, comme tout ce qui est nouveau, de tels changements peuvent sembler difficiles √† introduire.
        Le manque d'exp√©rience dans le travail avec les donn√©es, au moins dans les premi√®res √©tapes, fait que cette t√¢che peut sembler
        tout simplement impossible.
    </p>
    <p>
        Cependant, mon exp√©rience montre que le plus difficile est de commencer, quand nous avons d√©j√† :
    </p>
    <ul>
        <li>Quelques premiers <code>Pipelines</code> traitant les donn√©es</li>
        <li>Quelques ou une douzaine de sch√©mas de nos donn√©es</li>
        <li>Quelques transformations plus complexes</li>
        <li>Des tests pr√©par√©s</li>
        <li>Des processus et proc√©dures √©tablis</li>
    </ul>
    <p>
        Le travail avance comme une machine.
    </p>
    <p>
        Il faut cependant se rappeler qu'il n'existe pas de solution universelle unique qui conviendra √† chaque syst√®me.
        Dans chaque cas, il faut adapter l'approche √† la sp√©cificit√© du syst√®me et de l'organisation donn√©s.
    </p>

    <h2>Comment commencer ?</h2>
    <p>
        Si vous avez besoin d'aide pour construire un entrep√¥t de donn√©es central, je serai heureux de vous aider.<br/>
        <a href="https://norbert.tech/consulting">Contactez-moi</a>, et ensemble nous cr√©erons une solution parfaitement adapt√©e √† vos besoins.
    </p>
    <p>
        Je vous encourage √©galement √† visiter le serveur <a href="https://discord.gg/5dNXfQyACW" target="_blank">Discord - Flow PHP</a>, o√π
        nous pouvons discuter directement.
    </p>
    <div class="img-wide">
        <img src="https://norbert.tech/assets/images/blog/analytics-in-transactional-distributed-systems/consulting_01-fa277dfb3736a033cbfcf1ac931afb08.jpg" alt="Consultations" />
    </div>

    </article>
    <div class="mb-2 mx-auto max-w-screen-lg text-center">
        <script src="https://giscus.app/client.js"
                data-repo="norberttech/norbert.tech"
                data-repo-id="MDEwOlJlcG9zaXRvcnkyMjQ0MDQwNDA="
                data-category="Comments"
                data-category-id="DIC_kwDODWAiSM4CionD"
                data-mapping="pathname"
                data-strict="0"
                data-reactions-enabled="0"
                data-emit-metadata="0"
                data-input-position="bottom"
                data-theme="light"
                data-lang="en"
                crossorigin="anonymous"
                async>
        </script>
    </div>
    </main>

    <footer class="p-4 bg-sky-50 absolute bottom-0 w-full">
        <div class="mx-auto max-w-screen-2xl text-center">
            <a href="/">by @norbert_tech</a>
        </div>
    </footer>
</body>
</html>